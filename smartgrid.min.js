var smartGrid=function(t){"use strict";class e{events=new Map;maxListeners=10;on(t,e){if("function"!=typeof e)throw new TypeError("Listener must be a function");this.events.has(t)||this.events.set(t,[]);const i=this.events.get(t);return i.length>=this.maxListeners&&console.warn(`Possible EventEmitter memory leak detected. ${i.length+1} ${t} listeners added. Use setMaxListeners() to increase limit`),i.push(e),()=>this.off(t,e)}once(t,e){const i=(...s)=>{e(...s),this.off(t,i)};return i.listener=e,this.on(t,i)}off(t,e){if(!this.events.has(t))return!1;const i=this.events.get(t),s=i.findIndex(t=>t===e||t.listener===e);return-1!==s&&(i.splice(s,1),0===i.length&&this.events.delete(t),!0)}emit(t,...e){if(!this.events.has(t))return!1;const i=[...this.events.get(t)];for(const s of i)try{s(...e)}catch(e){console.error(`Error in event listener for "${t}":`,e),this.emit("error",{eventName:t,error:e,listener:s})}return!0}removeAllListeners(t){return t?this.events.delete(t):(this.events.clear(),!0)}listenerCount(t){return this.events.get(t)?.length??0}eventNames(){return Array.from(this.events.keys())}setMaxListeners(t){return this.maxListeners=t,this}getMaxListeners(){return this.maxListeners}}class i extends Error{constructor(t,e,i,s={}){super(t),this.name="SmartGridError",this.code=e,this.instanceId=i,this.details=s,this.timestamp=(new Date).toISOString()}}function s(t,e=0){if(null==t||""===t)return"";const i=parseFloat(t);return isNaN(i)?String(t):i.toLocaleString("ko-KR",{minimumFractionDigits:e,maximumFractionDigits:e})}function n(){return(new Date).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"-").replace(".","")}function a(t){return structuredClone(t)}class r{constructor(t){if(this.constructor===r)throw new TypeError('Abstract class "DataHandler" cannot be instantiated directly.');this.grid=t}async load(t){throw new Error('Method "load" must be implemented.')}async page(){throw new Error('Method "page" must be implemented.')}async sort(){throw new Error('Method "sort" must be implemented.')}async add(){throw new Error('Method "add" must be implemented.')}async save(){throw new Error('Method "save" must be implemented.')}async reject(){throw new Error('Method "reject" must be implemented.')}async delete(){throw new Error('Method "delete" must be implemented.')}getSortedData(){throw new Error('Method "getSortedData" must be implemented.')}updateTotalRowsInfo(){throw new Error('Method "updateTotalRowsInfo" must be implemented.')}}class o extends r{sortedDataCache=null;sortCacheKey=null;constructor(t){super(t),this.grid.pagingMode="client"}async load(t){const{grid:e}=this;try{if(!Array.isArray(t))throw new i("ë°ì´í„°ëŠ” ë°°ì—´ í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤.","INVALID_DATA",e.instanceId,{dataType:typeof t});e.info("ë°ì´í„° ë¡œë“œ ì‹œì‘",{rowCount:t.length}),t.length>1e4&&e.warn("LARGE_DATASET",`ëŒ€ìš©ëŸ‰ ë°ì´í„°(${t.length}í–‰)ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`);let s=a(t);return e.options.loadFilter&&(s=e.options.loadFilter(s)),s.forEach(t=>e.applyFormula(t)),e.originalData=s,e.originalDataBackup=a(e.originalData),e.totalRows=e.originalData.length,e.currentPage=1,this.sortedDataCache=null,this.sortCacheKey=null,e.options.isEditMode&&(e.isEditMode=!0),this.page(),e.emit("afterLoad",{data:e.originalData,totalRows:e.totalRows}),e.options.onLoadSuccess?.(e.originalData,e.totalRows,e),e.originalData}catch(t){throw e.handleError(t,"loadData"),e.emit("loadError",{error:t}),e.options.onLoadError?.(t,e),e.originalData=[],e.totalRows=0,this.sortedDataCache=null,this.sortCacheKey=null,this.page(),t}}page(){const{grid:t}=this,e=this.getSortedData();t.totalRows=e.length;const i=(t.currentPage-1)*t.pageSize,s=i+t.pageSize;if(t.currentPageData=e.slice(i,s),0===t.currentPageData.length&&t.totalRows>0)return t.currentPage=Math.ceil(t.totalRows/t.pageSize)||1,this.page();t.renderGrid(),t.columns.forEach(e=>t.updateSortIndicator(e.field)),t.renderPagination(),this.updateTotalRowsInfo()}sort(){this.invalidateSortCache(),this.grid.currentPage=1,this.page(),this.grid.columns.forEach(t=>this.grid.updateSortIndicator(t.field))}add(){const{grid:t}=this;if(t.isEditMode)return void t.showToast("ìˆ˜ì • ëª¨ë“œì—ì„œëŠ” í–‰ì„ ì¶”ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì €ì¥í•˜ê±°ë‚˜ ì·¨ì†Œí•´ì£¼ì„¸ìš”.","warning");if(t.changedRows.newRows.length>0)return void t.showToast("ë¨¼ì € ì¶”ê°€ëœ í–‰ì„ ì €ì¥í•´ì£¼ì„¸ìš”.","warning");t.emit("beforeRowAdd",{cancelled:!1}),t.originalDataBackup&&0!==t.originalDataBackup.length||(t.originalDataBackup=a(t.originalData));const e=t.columns.reduce((e,i,s)=>{if(i.formula)e[i.field]=t.evaluateFormula(i.formula,e,s);else{const s=i.editor?.defaultVal;let n;if("function"==typeof s)try{n=s(i,t)}catch(t){console.error(`defaultVal í•¨ìˆ˜ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ (í•„ë“œ: ${i.field}):`,t),n=void 0}void 0===n&&("selectbox"===i.editor?.type||"radiobutton"===i.editor?.type)&&Array.isArray(i.editor.options)&&i.editor.options.length>0&&(n=i.editor.options[0].val),e[i.field]=n??""}return e},{[t.idField]:`new_${Date.now()}`});t.originalData.unshift(e),t.changedRows.newRows.push(e),this.invalidateSortCache(),t.currentPage=1,this.page(),t.emit("afterRowAdd",{row:e}),t.showToast("ìƒˆ í–‰ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.","success")}async save(){const{grid:t}=this;if(!t.validateChanges())return;const{newRows:e,updatedRows:i,deletedRows:s}=t.changedRows;if(0===e.length&&0===i.length&&0===s.length)return void t.showToast("ë³€ê²½ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.","info");const n={changes:a(t.changedRows),cancelled:!1};if(t.emit("beforeSave",n),!n.cancelled)try{t.showToast(`ì´ ${e.length}ê°œ ì¶”ê°€, ${i.length}ê°œ ìˆ˜ì •, ${s.length}ê°œ ì‚­ì œ ì™„ë£Œ`,"success"),t.changedRows={newRows:[],updatedRows:[],deletedRows:[]},t.originalDataBackup=[],t.emit("afterSave",{changes:n.changes}),t.isEditMode?t.setEditMode(!1):t.renderGrid()}catch(e){t.emit("saveError",{error:e,changes:t.changedRows}),t.showToast("ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}async reject(){const{grid:t}=this;t.showConfirmModal("ëª¨ë“  ë³€ê²½ ì‚¬í•­ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",e=>{if(e){const e={changes:a(t.changedRows),cancelled:!1};if(t.emit("beforeCancel",e),e.cancelled)return;t.originalDataBackup&&t.originalDataBackup.length>0&&(t.originalData=a(t.originalDataBackup)),t.changedRows={newRows:[],updatedRows:[],deletedRows:[]},t.originalDataBackup=[],t.isEditMode&&(t.isEditMode=!1),this.invalidateSortCache(),this.page(),t.emit("afterCancel",{}),t.showToast("ëª¨ë“  ë³€ê²½ ì‚¬í•­ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.","info")}})}async delete(){const{grid:t}=this,e=t.currentPageData.filter(t=>t.checked);0!==e.length?t.showConfirmModal(`ì„ íƒëœ ${e.length}ê°œì˜ í–‰ì„ ì¦‰ì‹œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤)`,i=>{if(i){const i={rows:[...e],cancelled:!1};if(t.emit("beforeRowDelete",i),i.cancelled)return;const s=new Set(e.map(e=>e[t.idField]));t.changedRows.newRows=t.changedRows.newRows.filter(e=>!s.has(e[t.idField])),t.changedRows.updatedRows=t.changedRows.updatedRows.filter(e=>!s.has(e[t.idField])),t.originalData=t.originalData.filter(e=>!s.has(e[t.idField])),this.invalidateSortCache(),this.page(),t.emit("afterRowDelete",{rows:e}),t.showToast(`${e.length}ê°œì˜ í–‰ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`,"success")}}):t.showToast("ì‚­ì œí•  í–‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”.","warning")}getSortedData(){const{grid:t}=this,e=JSON.stringify(t.sortOrders);if(this.sortCacheKey===e&&this.sortedDataCache)return[...this.sortedDataCache];let i=[...t.originalData];return t.sortOrders.length>0&&i.sort(t.compareRowsForSort.bind(t)),this.sortedDataCache=i,this.sortCacheKey=e,[...i]}updateTotalRowsInfo(){const{grid:t}=this;if(!t.options.enableTotalRows||!t.totalRowsElement)return;const e=t.originalData.length;t.totalRowsElement.textContent=`ì „ì²´ ë°ì´í„°: ${e}ê°œ`}invalidateSortCache(){this.sortedDataCache=null,this.sortCacheKey=null}}class d extends r{constructor(t){if(super(t),this.grid.pagingMode="server",!this.grid.options.url)throw new i("ì„œë²„ URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.","INVALID_DATA",this.grid.instanceId)}async load(){const{grid:t}=this;t.showLoading();try{const e={params:t.lastParams,cancelled:!1};if(t.emit("beforeLoad",e),e.cancelled)return;const s={...t.options.queryParams,page:t.currentPage,pageSize:t.pageSize,sortOrders:t.sortOrders,...t.lastParams},n=await fetch(t.options.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!n.ok)throw new i(`ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${n.status} ${n.statusText}`,"INVALID_DATA",t.instanceId);const a=await n.json();if(!a.success)throw new i(a.error||"ì„œë²„ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","INVALID_DATA",t.instanceId);const r=t.options.loadFilter?t.options.loadFilter(a):a,o=r.rows??r.data??(Array.isArray(r)?r:[]),d=r.total??r.count??o.length;return o.forEach(e=>t.applyFormula(e)),t.originalData=o,t.totalRows=d,t.currentPageData=o,t.renderGrid(),t.renderPagination(),this.updateTotalRowsInfo(),t.columns.forEach(e=>t.updateSortIndicator(e.field)),t.emit("afterLoad",{data:o,totalRows:d}),t.options.onLoadSuccess?.(o,d,t),o}catch(e){throw t.handleError(e,"fetchData"),t.emit("loadError",{error:e}),t.options.onLoadError?.(e,t),t.renderGrid(),e}finally{await new Promise(t=>setTimeout(t,300)),t.hideLoading()}}async page(){await this.load()}async add(){const{grid:t}=this;if(t.isEditMode)return void t.showToast("ìˆ˜ì • ëª¨ë“œì—ì„œëŠ” í–‰ì„ ì¶”ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì €ì¥í•˜ê±°ë‚˜ ì·¨ì†Œí•´ì£¼ì„¸ìš”.","warning");if(t.changedRows.newRows.length>0)return void t.showToast("ë¨¼ì € ì¶”ê°€ëœ í–‰ì„ ì €ì¥í•´ì£¼ì„¸ìš”.","warning");const e={cancelled:!1};if(t.emit("beforeRowAdd",e),e.cancelled)return;const i=t.columns.reduce((e,i)=>{if(i.formula)e[i.field]=t.evaluateFormula(i.formula,e,i);else{const t=i.editor?.defaultVal;let s;if("function"==typeof t)try{s=t(i,this.grid)}catch(t){console.error(`defaultVal í•¨ìˆ˜ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ (í•„ë“œ: ${i.field}):`,t),s=void 0}void 0===s&&("selectbox"===i.editor?.type||"radiobutton"===i.editor?.type)&&Array.isArray(i.editor.options)&&i.editor.options.length>0&&(s=i.editor.options[0].val),e[i.field]=s??""}return e},{[t.idField]:`new_${Date.now()}`});t.currentPageData.unshift(i),t.changedRows.newRows.push(i),t.renderGrid(),t.emit("afterRowAdd",{row:i}),t.showToast("ìƒˆ í–‰ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. ì €ì¥ ì‹œ ì„œë²„ì— ë°˜ì˜ë©ë‹ˆë‹¤.","success")}async sort(){this.grid.currentPage=1,await this.load()}async save(){const{grid:t}=this;try{const{newRows:e,updatedRows:i,deletedRows:s}=t.changedRows;if(0===e.length&&0===i.length&&0===s.length)return void t.showToast("ë³€ê²½ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.","info");if(!t.validateChanges())return;const n={changes:a(t.changedRows),cancelled:!1};if(t.emit("beforeSave",n),n.cancelled)return;t.showLoading();const r={inserted:0,updated:0,deleted:0,errors:[]},{writeUrl:o,updateUrl:d,deleteUrl:l}=t.options;if(e.length>0&&o)try{const t=await this.sendRequest(o,e);r.inserted=t.inserted??e.length}catch(t){r.errors.push({type:"insert",error:t.message})}if(i.length>0&&d)try{const e=await this.sendRequest(d,i);r.updated=e.updated??i.length,t.isEditMode=!1}catch(t){r.errors.push({type:"update",error:t.message})}if(s.length>0&&l)try{const e=s.map(e=>e[t.idField]),i=await this.sendRequest(l,e);r.deleted=i.deleted??s.length}catch(t){r.errors.push({type:"delete",error:t.message})}if(t.hideLoading(),r.errors.length>0){const e=r.errors.map(t=>`${t.type}: ${t.error}`).join("\n");t.showToast(`ì¼ë¶€ ì‘ì—…ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n${e}`,"error"),t.emit("saveError",{results:r})}else t.showToast(`ì´ ${r.inserted}ê°œ ì¶”ê°€, ${r.updated}ê°œ ìˆ˜ì •, ${r.deleted}ê°œ ì‚­ì œ ì™„ë£Œ`,"success"),t.changedRows={newRows:[],updatedRows:[],deletedRows:[]},t.originalDataBackup=[],t.emit("afterSave",{results:r}),await this.load()}catch(e){t.handleError(e,"saveToServer"),t.emit("saveError",{error:e}),t.showToast("ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}async sendRequest(t,e){const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!i.ok)throw new Error(`Request failed with status ${i.status}`);const s=await i.json();if(!s.success)throw new Error(s.error||"Request failed");return s}async reject(){const{grid:t}=this;t.showConfirmModal("ëª¨ë“  ë³€ê²½ ì‚¬í•­ì„ ì·¨ì†Œí•˜ê³  ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?",e=>{if(e){const e={changes:a(t.changedRows),cancelled:!1};if(t.emit("beforeCancel",e),e.cancelled)return;t.changedRows={newRows:[],updatedRows:[],deletedRows:[]},t.originalDataBackup=[],t.isEditMode&&(t.isEditMode=!1),this.load(),t.emit("afterCancel",{}),t.showToast("ëª¨ë“  ë³€ê²½ ì‚¬í•­ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.","info")}})}async delete(){const{grid:t}=this,e=t.currentPageData.filter(t=>t.checked);0!==e.length?t.showConfirmModal(`ì„ íƒëœ ${e.length}ê°œì˜ í–‰ì„ ì„œë²„ì—ì„œ ì¦‰ì‹œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤)`,async i=>{if(i){const i={rows:[...e],cancelled:!1};if(t.emit("beforeRowDelete",i),i.cancelled)return;const s=e.map(e=>e[t.idField]);if(!t.options.deleteUrl)return void t.showToast("ì‚­ì œë¥¼ ì²˜ë¦¬í•  ì„œë²„ URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.","error");t.showLoading();try{const i=await fetch(t.options.deleteUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:s})});if(!i.ok)throw new Error(`ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${i.status}`);const n=await i.json();if(!n.success)throw new Error(n.error||"ì„œë²„ì—ì„œ ì‚­ì œ ì²˜ë¦¬ë¥¼ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");t.showToast(`${n.deleted}ê°œì˜ í–‰ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`,"success"),t.emit("afterRowDelete",{rows:e,result:n}),await this.load()}catch(e){t.handleError(e,"immediateDelete"),t.showToast("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","error")}finally{t.hideLoading()}}}):t.showToast("ì‚­ì œí•  í–‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”.","warning")}getSortedData(){return[...this.grid.currentPageData]}updateTotalRowsInfo(){const{grid:t}=this;t.options.enableTotalRows&&t.totalRowsElement&&(t.totalRowsElement.textContent=`ì „ì²´ ë°ì´í„°: ${t.totalRows}ê°œ`)}}class l{constructor(t){this.grid=t,this.selectOptionCache=new Map,this.inputConfigs={textbox:{type:"text",class:"smartgrid-input smartgrid-input-text"},email:{type:"email",class:"smartgrid-input smartgrid-input-email"},datebox:{type:"date",class:"smartgrid-input smartgrid-input-date"}},this.creators={numberbox:this.createNumberInput.bind(this),checkbox:this.createCheckboxInput.bind(this),selectbox:this.createSelectInput.bind(this),radiobutton:this.createRadioInput.bind(this)},Object.keys(this.inputConfigs).forEach(t=>{this.creators[t]=(e,i,s)=>this.createStandardInput(t,e,i,s)})}create(t,e,i){const s=t.editor.type||"textbox",n=this.creators[s];return n?n(t,e,i):(console.warn(`'${s}' íƒ€ì…ì˜ ì—ë””í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ì–´ textboxë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.`),this.createStandardInput("textbox",t,e,i))}CommonAttributes(t,e){const{editor:i}=e;i.placeholder&&(t.placeholder=i.placeholder),i.required&&(t.required=i.required),i.multiple&&(t.multiple=i.multiple),i.disabled&&(t.disabled=i.disabled),i.readonly&&(t.readOnly=i.readonly)}getDefault(t,e,i){const s=t.editor;let n="";"function"==typeof s.defaultVal?n=s.defaultVal(t,this.grid)??"":void 0!==s.defaultVal&&null!==s.defaultVal&&(n=s.defaultVal);let a=null!=i&&""!==i?i:n;return!t.formula||null!=a&&a!==isNaN||(a="numberbox"===s.type||"function"==typeof t.formula?0:""),a}createStandardInput(t,e,i,s){const n=this.inputConfigs[t],a=document.createElement("input");a.type=n.type,a.value=s??"",a.className=n.class,a.setAttribute("data-editor-type",t),this.CommonAttributes(a,e);const r=this.getDefault(e,i,s);return a.value=r,i[e.field]=r,a}createNumberInput(t,e,i){const s=document.createElement("input");s.type="number",s.step="any";const n=t.editor.decimalPlaces??0,a=null!=i&&""!==i?Number(i).toFixed(n):0;s.value=a,s.className="smartgrid-input smartgrid-input-number",void 0!==t.editor.min&&(s.min=t.editor.min),void 0!==t.editor.max&&(s.max=t.editor.max),void 0!==t.editor.step&&(s.step=t.editor.step),s.setAttribute("data-editor-type","numberbox"),this.CommonAttributes(s,t);const r=this.getDefault(t,e,i);return s.value=""!==r?Number(r):"",e[t.field]=s.value,s}createCheckboxInput(t,e,i){const s=document.createElement("div");s.className="smartgrid-d-flex smartgrid-justify-content-center smartgrid-align-items-center";const n=document.createElement("input");n.type="checkbox",n.className="smartgrid-input-checkbox",n.setAttribute("data-editor-type","checkbox"),this.CommonAttributes(n,t);const a=this.getDefault(t,e,i);return n.checked=!!a,e[t.field]=n.checked?1:0,s.appendChild(n),s}createSelectInput(t,e,i){const s=document.createElement("select");s.className="smartgrid-input-select",s.setAttribute("data-editor-type","selectbox"),this.CommonAttributes(s,t);const n=t.editor,a=n.valueField||"value",r=n.textField||"text",o=n.url;let d="";"function"==typeof n.defaultVal?d=n.defaultVal(t,this.grid)??"":void 0!==n.defaultVal&&null!==n.defaultVal&&(d=n.defaultVal);const l=n=>{const r=n.length>0?n[0][a]:"",o=null!=i&&""!==i?i:""!==d?d:r;s.value=o,e[t.field]=s.value},c=t=>{if(s.innerHTML="",!Array.isArray(t))throw new Error(`URL(${o})ì€ ë°°ì—´ì„ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤.`);return t.forEach(t=>{const e=document.createElement("option");e.value=t[a],e.textContent=t[r],s.appendChild(e)}),t};if(o&&"string"==typeof o){s.disabled=!0,s.innerHTML="<option>ë¡œë”© ì¤‘...</option>";let t=this.selectOptionCache.get(o);return t||(t=fetch(o).then(t=>{if(!t.ok)throw new Error(`Selectbox ì˜µì…˜ ë¡œë“œ ì‹¤íŒ¨: ${t.status}`);return t.json()}).catch(t=>{throw this.selectOptionCache.delete(o),t}),this.selectOptionCache.set(o,t)),t.then(c).then(t=>{l(t),s.disabled=!1}).catch(t=>{this.grid?.handleError?.(t,`createSelectInput.fetch(${o})`),s.innerHTML="<option>ë¡œë“œ ì‹¤íŒ¨</option>"}),s}if(Array.isArray(n.options)){const t=n.options;return t.forEach(t=>{const e=document.createElement("option");e.value=t[a],e.textContent=t[r],s.appendChild(e)}),l(t),s}return s.innerHTML="<option>ì˜µì…˜ ì—†ìŒ</option>",s}createRadioInput(t,e,i){const s=document.createElement("div");s.className="smartgrid-d-flex smartgrid-align-items-center",s.style.cssText="height: 100%; justify-content: flex-start; padding: 0 8px; flex-wrap: wrap;";const n=`radio_${t.field}_${e[this.grid.idField]}`;return(t.editor.options||[]).forEach(e=>{const a=`${n}_${e.val}`,r=document.createElement("div");r.style.cssText="display: inline-flex; align-items: center; margin-right: 12px; margin: 0;";const o=document.createElement("input");o.type="radio",o.id=a,o.name=n,o.value=e.val,o.className="smartgrid-input-radio",o.checked=String(e.val)===String(i),o.setAttribute("data-editor-type","radiobutton"),this.CommonAttributes(o,t);const d=document.createElement("label");d.className="smartgrid-input-radio-label",d.setAttribute("for",a),d.textContent=e.text,r.appendChild(o),r.appendChild(d),s.appendChild(r)}),s}createTextareaInput(t,e,i){const s=document.createElement("textarea");s.value=i??"",s.className="smartgrid-input-textarea",s.style.cssText="width: 100%; box-sizing: border-box; resize: none;",s.style.height="calc(var(--row-height, 30px) - 8px)",s.setAttribute("data-editor-type","textarea"),this.CommonAttributes(s,t);const n=this.getDefault(t,e,i);return s.value=n,e[t.field]=n,s.addEventListener("input",()=>{e[t.field]=s.value}),s}createRangeInput(t,e,i){const s=document.createElement("input");return s.type="range",s.value=i??"0",s.className="smartgrid-input-range",s.style.width="100%",void 0!==t.editor.min&&(s.min=t.editor.min),void 0!==t.editor.max&&(s.max=t.editor.max),void 0!==t.editor.step&&(s.step=t.editor.step),s.setAttribute("data-editor-type","range"),this.CommonAttributes(s,t),s}}class c{constructor(t){this.grid=t,this.toastElement=null,this.modalElement=null,this.contextMenuElement=null,this.columnPanelElement=null,this.loaderElement=null,this.paginationElement=null}createAll(){this.createToast(),this.createModal(),this.createContextMenu(),this.createLoader(),this.createColumnPanel(),this.grid.options.enablePagination&&this.createPagination()}createToast(){const t=document.createElement("div");t.id=`${this.grid.instanceId}_toast`,t.className="smartgrid-toast",t.setAttribute("data-instance",this.grid.instanceId),t.innerHTML=`\n      <div class="smartgrid-toast-header" data-instance="${this.grid.instanceId}">\n        <div class="smartgrid-toast-icon" id="${this.grid.instanceId}_toastIcon"></div>\n        <div class="smartgrid-toast-title" id="${this.grid.instanceId}_toastTitle">ì•Œë¦¼</div>\n        <button class="smartgrid-toast-close" data-instance="${this.grid.instanceId}">&times;</button>\n      </div>\n      <div class="smartgrid-toast-body" id="${this.grid.instanceId}_toastBody"></div>\n    `,document.body.appendChild(t),this.toastElement=t,this.toastTimer=null}showToast(t,e="info"){const i=this.toastElement;if(!i)return;const s=i.querySelector(`#${this.grid.instanceId}_toastIcon`),n=i.querySelector(`#${this.grid.instanceId}_toastTitle`),a=i.querySelector(`#${this.grid.instanceId}_toastBody`),r=i.querySelector(`.smartgrid-toast-close[data-instance="${this.grid.instanceId}"]`);i.classList.remove("info","success","error","warning"),i.classList.add(e),s.className=`smartgrid-toast-icon ${e}`,n.textContent=e.charAt(0).toUpperCase()+e.slice(1),a.textContent=t,this.toastTimer&&clearTimeout(this.toastTimer),i.classList.add("show");const o=()=>{i.classList.remove("show"),r.removeEventListener("click",o),this.toastTimer=null,setTimeout(()=>i.classList.remove(e),300)};r.addEventListener("click",o),this.toastTimer=setTimeout(o,3e3)}createModal(){const t=document.createElement("div");t.id=`${this.grid.instanceId}_modal`,t.className="smartgrid-modal",t.setAttribute("data-instance",this.grid.instanceId),t.innerHTML=`\n      <div class="smartgrid-modal-backdrop" data-instance="${this.grid.instanceId}"></div>\n      <div class="smartgrid-modal-content" data-instance="${this.grid.instanceId}">\n        <div class="smartgrid-modal-header">\n          <h5 class="smartgrid-modal-title">í™•ì¸</h5>\n          <button class="smartgrid-modal-close" data-instance="${this.grid.instanceId}">&times;</button>\n        </div>\n        <div class="smartgrid-modal-body">\n          <p id="${this.grid.instanceId}_modalText"></p>\n        </div>\n        <div class="smartgrid-modal-footer">\n          <button class="smartgrid-btn smartgrid-btn-secondary" data-dismiss="modal" data-instance="${this.grid.instanceId}">ì·¨ì†Œ</button>\n          <button class="smartgrid-btn smartgrid-btn-primary" id="${this.grid.instanceId}_modalConfirm" data-instance="${this.grid.instanceId}">í™•ì¸</button>\n        </div>\n      </div>\n    `,document.body.appendChild(t),this.modalElement=t}showConfirmModal(t,e){const i=this.modalElement;if(!i)return;const s=i.querySelector(`#${this.grid.instanceId}_modalText`),n=i.querySelector(`#${this.grid.instanceId}_modalConfirm`),a=i.querySelectorAll(`[data-dismiss="modal"][data-instance="${this.grid.instanceId}"]`),r=i.querySelector(`.smartgrid-modal-close[data-instance="${this.grid.instanceId}"]`),o=i.querySelector(`.smartgrid-modal-backdrop[data-instance="${this.grid.instanceId}"]`);s.textContent=t,i.classList.add("show");const d=()=>{e(!0),i.classList.remove("show"),c()},l=()=>{e(!1),i.classList.remove("show"),c()},c=()=>{n.removeEventListener("click",d),a.forEach(t=>t.removeEventListener("click",l)),r?.removeEventListener("click",l),o?.removeEventListener("click",l)};n.addEventListener("click",d),a.forEach(t=>t.addEventListener("click",l)),r?.addEventListener("click",l),o?.addEventListener("click",l)}createContextMenu(){const t=document.createElement("div");t.id=`${this.grid.instanceId}_contextMenu`,t.className="smartgrid-context-menu",t.setAttribute("data-instance",this.grid.instanceId),t.innerHTML=`\n      <div class="smartgrid-context-menu-item" data-action="copyCell" data-instance="${this.grid.instanceId}">ì…€ ë³µì‚¬</div>\n      <div class="smartgrid-context-menu-item" data-action="copyRow" data-instance="${this.grid.instanceId}">í–‰ ë³µì‚¬</div>\n      <div class="smartgrid-context-menu-divider"></div>\n      <div class="smartgrid-context-menu-item" data-action="addRow" data-instance="${this.grid.instanceId}">í–‰ ì¶”ê°€</div>\n      <div class="smartgrid-context-menu-item" data-action="deleteRow" data-instance="${this.grid.instanceId}">í–‰ ì‚­ì œ</div>\n      <div class="smartgrid-context-menu-divider"></div>\n      <div class="smartgrid-context-menu-item" data-action="toggleColumns" data-instance="${this.grid.instanceId}">ì—´ í‘œì‹œ/ìˆ¨ê¹€</div>\n    `,document.body.appendChild(t),this.contextMenuElement=t}showContextMenu(t,e,i,s){const n=this.contextMenuElement;n&&(n.style.display="none",setTimeout(()=>{n.style.display="block";if(window.innerWidth<768)n.classList.add("smartgrid-context-menu-mobile"),n.style.left="",n.style.top="";else{n.classList.remove("smartgrid-context-menu-mobile");const i=n.getBoundingClientRect(),s=window.innerWidth,a=window.innerHeight;let r=t,o=e;t+i.width>s-10&&(r=s-i.width-10),e+i.height>a-10&&(o=a-i.height-10),r<10&&(r=10),o<10&&(o=10),n.style.left=`${r}px`,n.style.top=`${o}px`}n.setAttribute("data-context-row-id",i),s&&n.setAttribute("data-context-cell-field",s)},10))}hideContextMenu(){this.contextMenuElement&&(this.contextMenuElement.style.display="none")}createColumnPanel(){const t=document.createElement("div");t.id=`${this.grid.instanceId}_columnPanel`,t.className="smartgrid-column-panel",t.setAttribute("data-instance",this.grid.instanceId),t.innerHTML=`\n      <div class="smartgrid-column-panel-header">ì—´ í‘œì‹œ ì„¤ì •</div>\n      <div class="smartgrid-column-panel-body" id="${this.grid.instanceId}_columnList"></div>\n    `,document.body.appendChild(t),this.columnPanelElement=t}toggleColumnVisibilityPanel(){const t=this.columnPanelElement;if(!t)return;if(t.classList.toggle("active")){const e=this.grid.wrapper.querySelector('[data-action="toggleColumns"]');if(e){const i=e.getBoundingClientRect();t.style.left=`${i.left}px`,t.style.top=`${i.bottom+5}px`}this.renderColumnVisibilityPanel()}}renderColumnVisibilityPanel(){const t=this.columnPanelElement.querySelector(`#${this.grid.instanceId}_columnList`);t&&(t.innerHTML="",this.grid.columns.forEach(e=>{if(e.hideColumn)return;const i=document.createElement("div");i.className="column-visibility-item";const s=`${this.grid.instanceId}_col_vis_${e.field}`,n=document.createElement("input");n.type="checkbox",n.id=s,n.className="smartgrid-input-checkbox",n.checked=!this.grid.hiddenColumns.has(e.field),n.addEventListener("change",t=>{this.grid[t.target.checked?"showColumn":"hideColumn"](e.field)});const a=document.createElement("label");a.setAttribute("for",s),a.textContent=e.title,i.appendChild(n),i.appendChild(a),t.appendChild(i)}))}createLoader(){const t=document.createElement("div");t.id=`${this.grid.instanceId}_loader`,t.className="smartgrid-skeleton-loader",t.setAttribute("data-instance",this.grid.instanceId),t.innerHTML='\n      <div class="smartgrid-skeleton-spinner"></div>\n      <div class="smartgrid-skeleton-text">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>\n    ',document.body.appendChild(t),this.loaderElement=t}showLoading(){this.loaderElement?.classList.add("active")}hideLoading(){this.loaderElement?.classList.remove("active")}createPagination(){const t=document.createElement("div");t.id=`${this.grid.instanceId}_pagination`,t.className="smartgrid-pagination",t.setAttribute("data-instance",this.grid.instanceId),this.grid.wrapper.appendChild(t),this.paginationElement=t}renderPagination(){if(!this.grid.options.enablePagination||!this.paginationElement)return;if(this.paginationElement.innerHTML="",0===this.grid.totalRows)return;const t=Math.ceil(this.grid.totalRows/this.grid.pageSize),e=Math.ceil(this.grid.currentPage/5),i=5*(e-1)+1,s=Math.min(t,5*e),n=document.createElement("ul"),a=document.createDocumentFragment(),r=i-1;a.appendChild(this.createPaginationButton('<i class="bi bi-chevron-double-left"></i>',r,!1,r<1));for(let t=i;t<=s;t++)a.appendChild(this.createPaginationButton(t,t,t===this.grid.currentPage));const o=s+1;a.appendChild(this.createPaginationButton('<i class="bi bi-chevron-double-right"></i>',o,!1,o>t)),n.appendChild(a),this.paginationElement.appendChild(n)}createPaginationButton(t,e,i=!1,s=!1){const n=document.createElement("li");n.className="page-item",i&&n.classList.add("active"),s&&n.classList.add("disabled");const a=document.createElement("button");return a.classList.add("page-link"),a.innerHTML=t,s||a.addEventListener("click",()=>{this.grid.currentPage=e,this.grid.changePage()}),n.appendChild(a),n}destroyAll(){this.toastElement?.remove(),this.modalElement?.remove(),this.contextMenuElement?.remove(),this.loaderElement?.remove(),this.columnPanelElement?.remove(),this.paginationElement?.remove(),this.toastElement=null,this.modalElement=null,this.contextMenuElement=null,this.loaderElement=null,this.columnPanelElement=null,this.paginationElement=null}}class h{constructor(t){this.grid=t}renderGrid(){try{this.clearTable(),this.grid.table.className="smartgrid-table",this.grid.table.setAttribute("data-instance",this.grid.instanceId),this.createTableHead(this.grid.table),this.createTableBody(this.grid.table),this.createTableFooter(this.grid.table),this.grid.columns.forEach(t=>{t.sortable&&this.grid.updateSortIndicator(t.field)})}catch(t){this.grid.handleError(t,"renderGrid")}}createColGroup(t){const e=document.createElement("colgroup");if(this.grid.enableCheckboxColumn){const t=document.createElement("col");t.className="sg-col-checkbox",t.style.width="var(--sg-col-checkbox-width)",e.appendChild(t)}if(this.grid.enableIndexColumn){const t=document.createElement("col");t.className="sg-col-index",t.style.width="var(--sg-col-index-width)",e.appendChild(t)}this.grid.columns.forEach(t=>{if(t.hideColumn||this.grid.hiddenColumns.has(t.field))return;const i=document.createElement("col");i.className="sg-col-data",i.setAttribute("data-field",t.field),t.width&&(i.style.width=t.width),e.appendChild(i)}),t.appendChild(e)}clearTable(){this.grid.table.replaceChildren()}createTableHead(t){const e=document.createElement("thead"),i=document.createElement("tr");this.addCheckboxHeader(i),this.addIndexHeader(i),this.addDataHeaders(i),e.appendChild(i),t.appendChild(e)}addCheckboxHeader(t){if(!this.grid.enableCheckboxColumn)return;const e=document.createElement("th");e.classList.add("sg-col-checkbox");const i=document.createElement("input");i.type="checkbox",i.classList.add("smartgrid-input-checkbox");const s=this.grid.currentPageData.length>0&&this.grid.currentPageData.every(t=>t.checked);i.checked=s,e.appendChild(i),t.appendChild(e)}addIndexHeader(t){if(!this.grid.enableIndexColumn)return;const e=document.createElement("th");e.classList.add("sg-col-index");const i=document.createElement("span");i.textContent="ë²ˆí˜¸",e.appendChild(i),t.appendChild(e)}addDataHeaders(t){this.grid.columns.forEach(e=>{if(e.hideColumn||this.grid.hiddenColumns.has(e.field))return;const i=document.createElement("th");i.style.width=e.width;const s=`sg-align-${e.headAlign||"center"}`;i.classList.add(s);const n=document.createElement("span");if(e.sortable){i.setAttribute("data-sortable","true"),i.setAttribute("data-field",e.field),i.style.cursor="pointer";const t=document.createElement("span");t.classList.add("col-title"),t.textContent=e.title,n.appendChild(t);const s=document.createElement("span");s.classList.add("sort-indicator"),s.innerHTML='<svg width="16" height="16" style="color: var(--sg-gray-400);"><use href="#icon-sort"></use></svg>',n.appendChild(s),this.grid.updateSortIndicator(e.field)}else n.textContent=e.title;if(i.appendChild(n),e.field){const t=document.createElement("div");t.classList.add("column-resizer"),t.setAttribute("data-field",e.field),t.addEventListener("mousedown",t=>this.grid.startColumnResize(t,e)),i.appendChild(t)}t.appendChild(i)})}createTableBody(t){const e=document.createElement("tbody");e.setAttribute("data-grid-body","true"),0===this.grid.currentPageData.length?this.addNoDataRow(e):this.addDataRows(e),t.appendChild(e)}addNoDataRow(t){const e=document.createElement("tr"),i=document.createElement("td"),s=this.grid.columns.filter(t=>!t.hideColumn&&!this.grid.hiddenColumns.has(t.field)).length;i.colSpan=s+(this.grid.enableCheckboxColumn?1:0)+(this.grid.enableIndexColumn?1:0),i.textContent="ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.",i.classList.add("smartgrid-text-center"),i.style.padding="2rem",i.style.color="var(--sg-gray-400)",e.appendChild(i),t.appendChild(e)}addDataRows(t){const e=document.createDocumentFragment();this.grid.currentPageData.forEach((t,i)=>{e.appendChild(this.createDataRow(t,i))}),t.appendChild(e)}createDataRow(t,e){const i=document.createElement("tr");i.setAttribute("data-row-id",t[this.grid.idField]);const s=this.grid.changedRows.newRows.includes(t),n=this.grid.changedRows.updatedRows.includes(t);return s?i.classList.add("row-new"):n&&i.classList.add("row-updated"),t.checked&&i.classList.add("row-checked"),this.grid.isEditMode&&i.classList.add("edit-mode"),this.grid.enableCheckboxColumn&&i.appendChild(this.createCheckboxCell(t)),this.grid.enableIndexColumn&&i.appendChild(this.createIndexCell(t,e)),this.grid.columns.forEach(e=>{e.hideColumn||this.grid.hiddenColumns.has(e.field)||i.appendChild(this.createDataCell(e,t,s))}),i}createCheckboxCell(t){const e=document.createElement("td");e.classList.add("sg-col-checkbox");const i=document.createElement("input");return i.type="checkbox",i.checked=!!t.checked,i.classList.add("smartgrid-input-checkbox"),i.setAttribute("data-row-checkbox","true"),i.setAttribute("data-row-id",t[this.grid.idField]),e.appendChild(i),e}createIndexCell(t,e){const i=document.createElement("td");return i.classList.add("sg-col-index"),i.textContent=(this.grid.currentPage-1)*this.grid.pageSize+e+1,i}createDataCell(t,e,i){const s=document.createElement("td");s.setAttribute("data-field",t.field),s.setAttribute("data-row-id",e[this.grid.idField]),t.width&&(s.style.width=t.width,s.style.minWidth=t.width);(!0===t.editor.readonly||!1===t.editor.editable)&&s.classList.add("sg-cell-readonly");const n=e[t.field]??t.editor?.defaultVal??"",a=t.editor?.editable??!0;if((i||this.grid.isEditMode)&&a)s.appendChild(this.grid.createCellInput(t,e,n)),"checkbox"===t.editor.type||t.editor.type;else{const i=document.createElement("span");i.innerHTML=t.render?t.render(n,e,t):this.formatValue(t,n),s.style.textAlign=t.cellAlign,s.appendChild(i)}return s}formatValue(t,e){if("numberbox"===t.editor.type)return s(e,t.editor.decimalPlaces||0);if("selectbox"===t.editor.type||"radiobutton"===t.editor.type){const i=(t.editor.options||[]).find(t=>String(t.val)===String(e));return i?i.text:e}return e}createTableFooter(t){if(!this.grid.columns.some(t=>t.sum))return;const e=t?.querySelector("tfoot");e?.remove();const i=document.createElement("tfoot"),n=document.createElement("tr");if(this.grid.enableCheckboxColumn){const t=document.createElement("td");t.classList.add("sg-col-checkbox"),t.appendChild(document.createElement("span")),n.appendChild(t)}if(this.grid.enableIndexColumn){const t=document.createElement("td");t.classList.add("sg-col-index");const e=document.createElement("span");e.textContent="í•©ê³„",t.appendChild(e),n.appendChild(t)}this.grid.columns.forEach(t=>{if(t.hideColumn||this.grid.hiddenColumns.has(t.field))return;const e=document.createElement("td"),i=document.createElement("span");if(t.width&&(e.style.width=t.width),t.sum&&"numberbox"===t.editor.type){const n=this.grid.currentPageData.reduce((e,i)=>e+(parseFloat(i[t.field])||0),0);i.textContent=s(n,t.editor.decimalPlaces||0),e.classList.add("sg-td-total")}e.appendChild(i),n.appendChild(e)}),i.appendChild(n),t.appendChild(i)}updateCellDisplay(t,e,i){const s=t.querySelector("input, select, textarea");if(s)if("checkbox"===s.type)s.checked=!!i;else if("number"===s.type){let t=i;"string"==typeof i&&(t=i.replace(/,/g,"")),t=parseFloat(t),isNaN(t)||void 0===e?.editor?.decimalPlaces||(t=parseFloat(t.toFixed(e.editor.decimalPlaces))),s.value=isNaN(t)?"":t}else s.value=null!=i?i:"";else{const e=t.querySelector("span");e&&(e.innerHTML=null!=i?i:"")}}updateTableFooter(){this.grid.table&&this.createTableFooter(this.grid.table)}}class u{constructor(t){this.grid=t,this.justResized=!1}setupEventDelegation(){const t=this.grid.table.querySelector("tbody[data-grid-body]"),e=this.grid.table.querySelector("thead");this.removeEventListeners(t,e),t&&(this.delegate(t,"change",this.handleBodyChange.bind(this)),this.delegate(t,"input",this.handleBodyChange.bind(this)),this.delegate(t,"contextmenu",this.handleBodyContextMenu.bind(this))),e&&this.delegate(e,"click",this.handleHeadClick.bind(this)),this.setupContextMenuEvents()}delegate(t,e,i){t[`${e}Handler`]=i,t.addEventListener(e,i)}removeEventListeners(t,e){t&&(t.changeHandler&&t.removeEventListener("change",t.changeHandler),t.inputHandler&&t.removeEventListener("input",t.inputHandler),t.contextmenuHandler&&t.removeEventListener("contextmenu",t.contextmenuHandler)),e&&e.clickHandler&&e.removeEventListener("click",e.clickHandler)}handleHeadClick(t){if(t.target.closest(".column-resizer"))return;const e=t.target.closest("thead th input[type='checkbox']");if(e)return this.handleMasterCheckboxClick(e);const i=t.target.closest("th[data-sortable='true']");return i?this.handleSortableHeaderClick(i):void 0}handleMasterCheckboxClick(t){this.grid.currentPageData.forEach(e=>e.checked=t.checked),this.grid.renderGrid()}handleSortableHeaderClick(t){if(this.justResized)return;const e=t.getAttribute("data-field");e&&this.grid.sortColumn(e)}handleBodyChange(t){const e=t.target.closest("input[data-editor-type], select[data-editor-type], textarea[data-editor-type]");if(e)return this.handleInputChange(e);const i=t.target.closest('input[type="checkbox"][data-row-checkbox="true"]');return i?this.handleRowCheckboxChange(i):void 0}handleInputChange(t){const e=t.closest("td[data-field]"),i=t.closest("tr[data-row-id]");if(!e||!i)return;const s=e.getAttribute("data-field"),n=i.getAttribute("data-row-id"),a=this.grid.findRowData(n);if(!a)return;let r;r="checkbox"===t.type?t.checked:"radio"===t.type?i.querySelector(`input[name="${t.name}"]:checked`)?.value??"":t.value,this.grid.updateRowData(a,s,r)}handleRowCheckboxChange(t){const e=t.getAttribute("data-row-id"),i=this.grid.findRowData(e);if(i){i.checked=t.checked;const e=t.closest("tr[data-row-id]");e&&e.classList.toggle("row-checked",t.checked)}}handleBodyContextMenu(t){t.preventDefault(),t.stopPropagation();const e=t.target.closest("tr[data-row-id]");if(!e)return;const i=e.getAttribute("data-row-id"),s=t.target.closest("td[data-field]"),n=s?.getAttribute("data-field");this.grid.findRowData(i)&&this.grid.uiComponents.showContextMenu(t.pageX,t.pageY,i,n)}setupContextMenuEvents(){const t=this.grid.uiComponents.contextMenuElement;if(!t||t.hasClickHandler)return;t.addEventListener("click",e=>{e.stopPropagation();const i=e.target.closest(`.smartgrid-context-menu-item[data-instance="${this.grid.instanceId}"]`);if(!i)return;const s=i.getAttribute("data-action"),n=t.getAttribute("data-context-row-id"),a=t.getAttribute("data-context-cell-field");t.style.display="none",this.handleContextMenuAction(s,n,a),t.removeAttribute("data-context-row-id"),t.removeAttribute("data-context-cell-field")}),t.hasClickHandler=!0}handleContextMenuAction(t,e,i){switch(t){case"copyCell":e&&i&&this.copyCellValue(e,i);break;case"copyRow":e&&this.copyRowData(e);break;case"addRow":this.grid.addRow();break;case"deleteRow":if(e){const t=this.grid.findRowData(e);t&&(t.checked=!0,this.grid.deleteRow())}break;case"toggleColumns":this.grid.uiComponents.toggleColumnVisibilityPanel()}}async copyCellValue(t,e){const i=this.grid.findRowData(t);if(i)try{await navigator.clipboard.writeText(String(i[e]??"")),this.grid.showToast("ì…€ ê°’ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.","success")}catch(t){this.grid.showToast("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}async copyRowData(t){const e=this.grid.findRowData(t);if(!e)return;const i=this.grid.columns.filter(t=>!t.hideColumn&&!this.grid.hiddenColumns.has(t.field)).map(t=>e[t.field]??"").join("\t");try{await navigator.clipboard.writeText(i),this.grid.showToast("í–‰ ë°ì´í„°ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.","success")}catch(t){this.grid.showToast("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}startColumnResize(t,e){this.grid.isResizing=!0,this.grid.resizeStartX=t.clientX,this.grid.resizeField=e.field;const i=t.target.closest("th");this.grid.resizeStartWidth=i.offsetWidth,this.grid.table.classList.add("resizing-active"),document.body.style.cursor="col-resize",t.preventDefault()}handleColumnResizeMove(t){if(!this.grid.isResizing)return;const e=this.grid.table.querySelector(`.column-resizer[data-field="${this.grid.resizeField}"]`);if(!e)return;const i=e.closest("th");if(!i)return;const s=t.clientX-this.grid.resizeStartX;let n=this.grid.resizeStartWidth+s;n<50&&(n=50),i.style.width=`${n}px`,i.style.minWidth=`${n}px`}handleColumnResizeEnd(){if(!this.grid.isResizing)return;this.grid.isResizing=!1,this.grid.table.classList.remove("resizing-active"),document.body.style.cursor="";const t=this.grid.columns.find(t=>t.field===this.grid.resizeField);if(t){const e=this.grid.table.querySelector(`.column-resizer[data-field="${this.grid.resizeField}"]`),i=e?.closest("th");i&&(t.width=`${i.offsetWidth}px`)}this.justResized=!0,setTimeout(()=>{this.justResized=!1},200),this.grid.resizeField=null}}class g{constructor(t){if(!t)throw new Error("PluginManager requires a SmartGrid instance");this.grid=t,this.plugins=new Map,this.initializationOrder=[]}register(t,e={}){try{const i=new t(this.grid,e);if(!i.name||"string"!=typeof i.name)throw new Error("í”ŒëŸ¬ê·¸ì¸ì€ name ì†ì„±(string)ì´ í•„ìš”í•©ë‹ˆë‹¤");const s=i.name;return this.plugins.has(s)&&(this.grid.warn("PLUGIN_ALREADY_REGISTERED",`í”ŒëŸ¬ê·¸ì¸ "${s}"ì´ ì´ë¯¸ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë®ì–´ì”ë‹ˆë‹¤.`),this.unregister(s)),this.plugins.set(s,i),this.initializationOrder.push(s),this._definePluginAccessor(s),"function"==typeof i.install&&i.install(),this.grid.info(`í”ŒëŸ¬ê·¸ì¸ "${s}" v${i.version||"1.0.0"} ë“±ë¡ ì™„ë£Œ`),this.grid.emit("pluginRegistered",{name:s,version:i.version||"1.0.0",instance:i}),this.grid}catch(t){throw this.grid.handleError(t,"PluginManager.register"),t}}unregister(t){try{const e=this.plugins.get(t);if(!e)return this.grid.warn("PLUGIN_NOT_FOUND",`í”ŒëŸ¬ê·¸ì¸ "${t}"ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),!1;"function"==typeof e.uninstall&&e.uninstall(),this._removePluginAccessor(t),this.plugins.delete(t);const i=this.initializationOrder.indexOf(t);return-1!==i&&this.initializationOrder.splice(i,1),this.grid.info(`í”ŒëŸ¬ê·¸ì¸ "${t}" ì œê±° ì™„ë£Œ`),this.grid.emit("pluginUnregistered",{name:t}),!0}catch(t){return this.grid.handleError(t,"PluginManager.unregister"),!1}}has(t){return this.plugins.has(t)}get(t){return this.plugins.get(t)||null}getNames(){return Array.from(this.plugins.keys())}getAll(){return Array.from(this.plugins.values())}getAllAsMap(){return new Map(this.plugins)}unregisterAll(){[...this.initializationOrder].reverse().forEach(t=>this.unregister(t)),this.plugins.size>0&&this.plugins.forEach((t,e)=>{this.unregister(e)})}get count(){return this.plugins.size}isInstalled(t){const e=this.get(t);return!!e&&("function"==typeof e.isInstalled?e.isInstalled():!0===e.initialized)}filter(t){if("function"!=typeof t)throw new Error("filter requires a function");return this.getAll().filter(t)}getPluginInfoList(){return this.getAll().map(t=>({name:t.name,version:t.version||"1.0.0",installed:this.isInstalled(t.name),options:t.options||{}}))}getInitializationOrder(){return[...this.initializationOrder]}validateDependencies(t){const e=this.get(t);if(!e)return!1;const i=e.dependencies||[];if(0===i.length)return!0;const s=i.filter(t=>!this.has(t));return!(s.length>0)||(this.grid.warn("PLUGIN_DEPENDENCY_MISSING",`í”ŒëŸ¬ê·¸ì¸ "${t}"ì˜ ì˜ì¡´ì„±ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤: ${s.join(", ")}`),!1)}validateAllDependencies(){let t=!0;return this.getNames().forEach(e=>{this.validateDependencies(e)||(t=!1)}),t}_definePluginAccessor(t){void 0===this.grid[t]?Object.defineProperty(this.grid,t,{get(){return this.pluginManager.plugins.get(t)},configurable:!0,enumerable:!1}):this.grid.warn("PLUGIN_NAME_CONFLICT",`í”ŒëŸ¬ê·¸ì¸ ì´ë¦„ "${t}"ì´ ì´ë¯¸ SmartGridì˜ ì†ì„±/ë©”ì„œë“œì™€ ì¶©ëŒí•©ë‹ˆë‹¤.`)}_removePluginAccessor(t){if(void 0!==this.grid[t])try{delete this.grid[t]}catch(e){this.grid.warn("PLUGIN_ACCESSOR_REMOVAL_FAILED",`í”ŒëŸ¬ê·¸ì¸ "${t}"ì˜ ì ‘ê·¼ì ì œê±°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.`)}}debug(t=!1){this.grid.debugMode&&(console.group(`ğŸ”Œ Plugin Manager [${this.grid.tableId}]`),console.log(`Total Plugins: ${this.count}`),console.log(`Initialization Order: ${this.initializationOrder.join(" â†’ ")}`),t?this.plugins.forEach((t,e)=>{console.group(`  ğŸ“¦ ${e}`),console.log(`    Version: ${t.version||"1.0.0"}`),console.log("    Installed: "+(this.isInstalled(e)?"âœ“":"âœ—")),console.log(`    Dependencies: ${t.dependencies?.join(", ")||"None"}`),console.log("    Options:",t.options),console.groupEnd()}):this.plugins.forEach((t,e)=>{const i=this.isInstalled(e)?"âœ“":"âœ—";console.log(`  ${i} ${e} (v${t.version||"1.0.0"})`)}),console.groupEnd())}exportConfigs(){return this.getAll().map(t=>({name:t.name,version:t.version||"1.0.0",options:{...t.options}}))}async batchRegister(t){if(!Array.isArray(t))throw new Error("batchRegister requires an array of plugin configs");for(const e of t)if(e.Plugin)try{await this.register(e.Plugin,e.options||{})}catch(t){this.grid.handleError(t,"PluginManager.batchRegister")}else this.grid.warn("INVALID_PLUGIN_CONFIG","Plugin ì†ì„±ì´ ëˆ„ë½ëœ ì„¤ì •ì´ ìˆìŠµë‹ˆë‹¤.");return this.grid}enable(t){const e=this.get(t);return e?this.isInstalled(t)?(this.grid.info(`í”ŒëŸ¬ê·¸ì¸ "${t}"ì€ ì´ë¯¸ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.`),!0):"function"==typeof e.install&&(e.install(),this.grid.info(`í”ŒëŸ¬ê·¸ì¸ "${t}" í™œì„±í™”ë¨`),this.grid.emit("pluginEnabled",{name:t}),!0):(this.grid.warn("PLUGIN_NOT_FOUND",`í”ŒëŸ¬ê·¸ì¸ "${t}"ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),!1)}disable(t){const e=this.get(t);return e?this.isInstalled(t)?"function"==typeof e.uninstall&&(e.uninstall(),this.grid.info(`í”ŒëŸ¬ê·¸ì¸ "${t}" ë¹„í™œì„±í™”ë¨`),this.grid.emit("pluginDisabled",{name:t}),!0):(this.grid.info(`í”ŒëŸ¬ê·¸ì¸ "${t}"ì€ ì´ë¯¸ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.`),!0):(this.grid.warn("PLUGIN_NOT_FOUND",`í”ŒëŸ¬ê·¸ì¸ "${t}"ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),!1)}restart(t){return this.get(t)?(this.disable(t),this.enable(t)):(this.grid.warn("PLUGIN_NOT_FOUND",`í”ŒëŸ¬ê·¸ì¸ "${t}"ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),!1)}getStatus(){const t=[],e=[];return this.plugins.forEach((i,s)=>{this.isInstalled(s)?t.push(s):e.push(s)}),{installed:t,uninstalled:e}}getStats(){const t=this.getStatus();return{total:this.count,installed:t.installed.length,uninstalled:t.uninstalled.length,names:this.getNames(),initOrder:this.getInitializationOrder()}}}class m extends e{static BUTTON_CONFIG={Add:{text:"ì¶”ê°€",action:"addRow",icon:"bi bi-plus-lg"},Edit:{text:"ìˆ˜ì •",action:"setEditMode",params:[!0],icon:"bi bi-pencil-square"},Save:{text:"ì €ì¥",action:"saveRow",icon:"bi bi-save"},Cancel:{text:"ì·¨ì†Œ",action:"rejectRow",icon:"bi bi-x-circle"},Delete:{text:"ì‚­ì œ",action:"deleteRow",icon:"bi bi-trash"},Print:{text:"ì¸ì‡„",action:"printCurrentPage",icon:"bi bi-printer"}};static PAGE_SIZE_OPTIONS=[{value:10,text:"10ê°œì”©"},{value:20,text:"20ê°œì”©"},{value:50,text:"50ê°œì”©"},{value:100,text:"100ê°œì”©"},{value:"all",text:"ì „ì²´ ë³´ê¸°"}];static instances=new Set;static globalEventsInitialized=!1;table;options;wrapper=null;dataHandler=null;renderer=null;eventHandler=null;uiComponents=null;pluginManager=null;columns=[];originalData=[];originalDataBackup=[];currentPageData=[];totalRows=0;pageSize=10;currentPage=1;pagingMode="client";isEditMode=!1;changedRows={newRows:[],updatedRows:[],deletedRows:[]};sortOrders=[];rowHeight=35;isResizing=!1;resizeStartX=0;resizeStartWidth=0;resizeField=null;hiddenColumns=new Set;inputFactory=null;filters={};warnings=[];lastParams={};constructor(t,e={}){super();try{if(this.tableId=t,this.instanceId=`sg_${t}`,this.debugMode=e.debug??!1,this.table=document.getElementById(t),!this.table)throw new i(`í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: "${t}"`,"ELEMENT_NOT_FOUND",this.instanceId,{tableId:t});m.instances.add(this),this.columns=e.columns||[],this.options={idField:"id",pageSize:10,page:1,pagingMode:"client",rowHeight:35,enableCheckboxColumn:!0,enableIndexColumn:!0,enableEditMode:!0,loadFilter:null,onLoadSuccess:null,onLoadError:null,enableToolbar:!0,enablePagination:!0,enableTotalRows:!0,enablePageSizeSelect:!0,toolbarButtons:Object.keys(m.BUTTON_CONFIG),queryParams:{},...e},this.lastParams=this.options.queryParams||{},this.pageSize=this.options.pageSize,this.currentPage=this.options.page,this.rowHeight=this.options.rowHeight,this.pluginManager=new g(this),"server"===this.options.pagingMode&&this.options.url?this.dataHandler=new d(this):this.dataHandler=new o(this),this.renderer=new h(this),this.eventHandler=new u(this),this.uiComponents=new c(this),this.initializeColumns(),this.setRowHeight(this.rowHeight,!1),this.createWrapper(),this.createUIElements(),this.initializeGlobalEvents(),this.validateConfiguration(),this.info("ê·¸ë¦¬ë“œ ì´ˆê¸°í™” ì™„ë£Œ")}catch(t){throw this.handleError(t,"constructor"),t}}get idField(){return this.options.idField}get enableCheckboxColumn(){return this.options.enableCheckboxColumn}get enableIndexColumn(){return this.options.enableIndexColumn}get editModeEnabled(){return this.options.enableEditMode}static getInstance(t){for(const e of m.instances)if(e.instanceId===t)return e;return null}static findByTableId(t){for(const e of m.instances)if(e.tableId===t)return e;return null}static getAllInstances(){return Array.from(m.instances)}use(t,e={}){return this.pluginManager.register(t,e)}removePlugin(t){return this.pluginManager.unregister(t)}hasPlugin(t){return this.pluginManager.has(t)}getPluginNames(){return this.pluginManager.getNames()}getPlugin(t){return this.pluginManager.get(t)}initializeColumns(){this.columns.forEach((t,e)=>{t.field??(t.field=t.hideColumn?void 0:`column_${e}`),t.title??(t.title=t.field||`ì»¬ëŸ¼ ${e+1}`),t.width??(t.width="auto"),t.headAlign??(t.headAlign="center"),t.print??(t.print=!0),t.exportExcel??(t.exportExcel=!0),"object"==typeof t.editor&&null!==t.editor||(t.editor={type:t.editor||"textbox"}),t.cellAlign??(t.cellAlign="numberbox"===t.editor.type?"right":"left")})}_bindRowClick(){const t=this.table?.querySelector("tbody");t&&(this._rowClickHandler&&t.removeEventListener("click",this._rowClickHandler),this._rowClickHandler=e=>{const i=e.target.closest("tr[data-row-id]");if(!i)return;const s=i.getAttribute("data-row-id"),n=this.findRowData(s);n&&(t.querySelectorAll("tr").forEach(t=>t.classList.remove("sg-row-selected")),i.classList.add("sg-row-selected"),this.emit("rowClick",n,e))},t.addEventListener("click",this._rowClickHandler))}createWrapper(){const t=document.createElement("div");t.className="smartgrid-container",this.table.parentNode.insertBefore(t,this.table),t.appendChild(this.table);const e=document.createElement("div");e.className="smartgrid-wrapper",e.setAttribute("data-instance",this.instanceId),e.setAttribute("data-grid-id",this.tableId),void 0!==this.options.width&&(e.style.width="number"==typeof this.options.width?`${this.options.width}px`:this.options.width),t.parentNode.insertBefore(e,t),e.appendChild(t),void 0!==this.options.height&&(t.style.height="number"==typeof this.options.height?`${this.options.height}px`:this.options.height),t.style.overflow="auto",t.setAttribute("data-instance",this.instanceId),t.setAttribute("data-grid-id",this.tableId),this.wrapper=e}createUIElements(){this.uiComponents.createAll(),(this.options.enableToolbar||this.options.enableTotalRows||this.options.enablePageSizeSelect)&&this.createToolbar()}createToolbar(){if(!this.options.enableToolbar&&!this.options.enableTotalRows&&!this.options.enablePageSizeSelect)return;const t=document.createElement("div");t.className="smartgrid-toolbar-container",t.setAttribute("data-grid-id",this.tableId);const e=document.createElement("div");if(e.className="smartgrid-toolbar-section",this.options.enableToolbar){const t=document.createElement("div");t.className="smartgrid-toolbar-group",e.appendChild(t);const i=this.options.toolbarButtons;(Array.isArray(i)?i.map(t=>[null,t]):Object.entries(i)).forEach(([e,i])=>{let s;s="string"==typeof i?m.BUTTON_CONFIG[i]:i[Object.keys(i)[0]];const n=document.createElement("button");n.className=s.className?s.className:"smartgrid-btn smartgrid-btn-secondary";const a=s.icon?`<i class="${s.icon}"></i>`:"";n.innerHTML=`${a}<span>${s.text}</span>`,n.addEventListener("click",t=>{if(t.stopPropagation(),"function"==typeof s.action)s.action.call(this,t);else if("string"==typeof s.action){const t=this[s.action];"function"==typeof t&&t.apply(this,s.params||[])}}),t.appendChild(n)})}const i=document.createElement("div");if(i.className="smartgrid-toolbar-section",this.options.enableTotalRows){const t=document.createElement("div");t.id=`${this.instanceId}_totalRows`,t.className="smartgrid-info-text",i.appendChild(t),this.totalRowsElement=t}if(this.options.enablePageSizeSelect){const t=document.createElement("select");t.id=`${this.instanceId}_pageSize`,t.className="smartgrid-select",t.innerHTML=m.PAGE_SIZE_OPTIONS.map(t=>`<option value="${t.value}">${t.text}</option>`).join(""),t.value=this.pageSize,t.addEventListener("change",t=>{const e=t.target.value;"all"===e?"client"===this.pagingMode?(this.setPageSize(this.getSortedData().length||1),this.changePage()):this.totalRows>0?(this.setPageSize(this.totalRows),this.changePage()):(this.showToast("ì„œë²„ì‚¬ì´ë“œ ëª¨ë“œì—ì„œëŠ” 'ì „ì²´ ë³´ê¸°'ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.","warning"),t.target.value=this.pageSize):(this.setPageSize(parseInt(e,10)),this.changePage())}),i.appendChild(t),this.pageSizeSelectElement=t}e.children.length>0&&t.appendChild(e),i.children.length>0&&t.appendChild(i),t.children.length>0&&(this.wrapper.insertBefore(t,this.wrapper.firstChild),this.toolbarElement=t)}initializeGlobalEvents(){m.globalEventsInitialized||(document.addEventListener("mousemove",t=>{m.instances.forEach(e=>{e.isResizing&&e.eventHandler.handleColumnResizeMove(t)})}),document.addEventListener("mouseup",t=>{m.instances.forEach(e=>{e.isResizing&&e.eventHandler.handleColumnResizeEnd(t)})}),document.addEventListener("click",t=>{m.instances.forEach(e=>{const i=e.uiComponents.contextMenuElement;if(i&&!i.contains(t.target)){t.target.closest(".smartgrid-context-menu-item")&&t.target.getAttribute("data-instance")===e.instanceId||(i.style.display="none")}const s=e.uiComponents.columnPanelElement;if(s&&!s.contains(t.target)){const i=document.getElementById(`${e.instanceId}_toggleColumnsBtn`);i&&i.contains(t.target)||s.classList.remove("active")}})}),m.globalEventsInitialized=!0)}validateConfiguration(){this.columns&&0!==this.columns.length||this.warn("NO_COLUMNS","ì»¬ëŸ¼ì´ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë¹ˆ í…Œì´ë¸”ì´ í‘œì‹œë©ë‹ˆë‹¤.");const t=this.columns.map(t=>t.field).filter(Boolean),e=t.filter((e,i)=>t.indexOf(e)!==i);e.length>0&&this.warn("DUPLICATE_FIELDS",`ì¤‘ë³µëœ í•„ë“œ IDê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤: ${e.join(", ")}`),this.options.pageSize>100&&this.warn("LARGE_PAGE_SIZE",`í˜ì´ì§€ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤: ${this.options.pageSize}. ì„±ëŠ¥ ì €í•˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`)}async loadData(t){if(this.dataHandler instanceof o)return this.dataHandler.load(t);this.warn("INVALID_OPERATION","ì„œë²„ ëª¨ë“œì—ì„œëŠ” loadData ëŒ€ì‹  fetchDataë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.")}async fetchData(t){return void 0!==t&&(this.lastParams=t),this.dataHandler.load()}async sortColumn(t){this.emit("beforeSort",{field:t,sortOrders:[...this.sortOrders]});const e=this.sortOrders.findIndex(e=>e.field===t);if(-1!==e){const t=this.sortOrders[e].order;"asc"===t?this.sortOrders[e].order="desc":"desc"===t&&this.sortOrders.splice(e,1)}else this.sortOrders.push({field:t,order:"asc"});await this.dataHandler.sort(),this.emit("afterSort",{field:t,sortOrders:[...this.sortOrders]})}async changePage(){const t={currentPage:this.currentPage,cancelled:!1};this.emit("beforePageChange",t),t.cancelled||(await this.dataHandler.page(),this.emit("afterPageChange",{currentPage:this.currentPage}))}setPageSize(t){this.pageSize=parseInt(t,10),this.currentPage=1}addRow(){this.dataHandler.add()}saveRow(){this.dataHandler.save()}rejectRow(){this.dataHandler.reject()}deleteRow(){this.dataHandler.delete()}getData(){return this.getSortedData()}getSortedData(){return this.dataHandler.getSortedData()}getRows(){return[...this.currentPageData]}getCheckedRows(){return this.currentPageData&&Array.isArray(this.currentPageData)?this.currentPageData.filter(t=>!0===t.checked):(this.warn("GET_CHECKED_ROWS_FAILED","í˜„ì¬ í˜ì´ì§€ ë°ì´í„°ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."),[])}updateTotalRowsInfo(){this.dataHandler.updateTotalRowsInfo()}invalidateSortCache(){this.dataHandler instanceof o&&this.dataHandler.invalidateSortCache()}renderGrid(){this.renderer.renderGrid(),this.eventHandler.setupEventDelegation(),this._bindRowClick()}renderPagination(){this.uiComponents.renderPagination()}updateSortIndicator(t){const e=this.table.querySelector(`th[data-field="${t}"]`);if(!e)return;const i=e.querySelector(".sort-indicator");if(!i)return;const{order:s,index:n}=this.getSortOrder(t);let a="";null!==n&&(a+=`<span class="smartgrid-badge">${n}</span>`),a+="asc"===s?'<i class="bi bi-caret-up-fill" style="font-size:12px; color: var(--sg-gray-900);"></i>':"desc"===s?'<i class="bi bi-caret-down-fill" style="font-size:12px; color: var(--sg-gray-900);"></i>':'<i class="bi bi-arrow-down-up" style="font-size:12px; color: var(--sg-gray-400);"></i>',i.innerHTML=a}startColumnResize(t,e){this.eventHandler.startColumnResize(t,e)}getInputFactory(){return this.inputFactory??=new l(this),this.inputFactory}createCellInput(t,e,i){return this.getInputFactory().create(t,e,i)}updateRowData(t,e,i){if(t[e]===i)return;const n=t[e],a=this.columns.find(t=>t.field===e),r={rowData:t,field:e,oldValue:n,newValue:i,cancelled:!1};if(this.emit("beforeCellChange",r),r.cancelled)return;"numberbox"===a?.editor.type&&(""===i||null==i?i=null:("string"==typeof i&&(i=i.replace(/,/g,"")),i=parseFloat(i)||0,void 0!==a.editor.decimalPlaces&&(i=parseFloat(i.toFixed(a.editor.decimalPlaces))))),t[e]=i;const o=this.table.querySelector(`tr[data-row-id="${t[this.idField]}"]`),d=this.columns.filter(t=>"function"==typeof t.formula);if(d.length>0&&o){const e=new Map(Array.from(o.querySelectorAll("td[data-field]")).map(t=>[t.getAttribute("data-field"),t]));d.forEach((i,n)=>{let a=this.evaluateFormula(i.formula,t,i,n);isNaN(a)&&(a=0),"numberbox"===i.editor.type&&void 0!==i.editor.decimalPlaces&&(a=parseFloat(a.toFixed(i.editor.decimalPlaces))),t[i.field]=a;const r=e.get(i.field);if(r){let t=a;if("numberbox"===i.editor.type&&void 0!==i.editor.decimalPlaces){t=s(a,i.editor.decimalPlaces)}this.renderer.updateCellDisplay(r,i,t)}})}this.changedRows.newRows.includes(t)||this.changedRows.updatedRows.includes(t)||(this.changedRows.updatedRows.push(t),o?.classList.add("row-updated")),this.invalidateSortCache(),this.renderer.updateTableFooter(),this.emit("afterCellChange",{rowData:t,field:e,oldValue:n,newValue:i})}findRowData(t){const e=e=>String(e[this.idField])===String(t);return this.currentPageData.find(e)||this.originalData.find(e)}applyFormula(t){this.columns.forEach((e,i)=>{e.formula&&(t[e.field]=this.evaluateFormula(e.formula,t,e,i))})}evaluateFormula(t,e,i,s){if("function"==typeof t)try{let n=t(e,i,s);return isNaN(n)?0:n}catch(t){return console.error(`Error executing formula for column "${i.field}":`,t),0}}compareRowsForSort(t,e){for(const{field:i,order:s}of this.sortOrders){const n=t[i]??"",a=e[i]??"";if(n<a)return"asc"===s?-1:1;if(n>a)return"asc"===s?1:-1}return 0}applyFilters(t){return this.filters&&0!==Object.keys(this.filters).length?t.filter(t=>{if(this.filters.keyword){const e=this.filters.keyword.toLowerCase();if(!["fCode","fName","fOrigin","comment"].some(i=>String(t[i]||"").toLowerCase().includes(e)))return!1}return!(this.filters.startDate&&t.expDate<this.filters.startDate)&&(!(this.filters.endDate&&t.expDate>this.filters.endDate)&&!(this.filters.status&&this.filters.status.length>0&&!this.filters.status.includes(t.stockStatus)))}):t}getSortOrder(t){const e=this.sortOrders.find(e=>e.field===t),i=this.sortOrders.findIndex(e=>e.field===t);return{order:e?.order||null,index:-1!==i?i+1:null}}setRowHeight(t,e=!0){this.rowHeight=parseInt(t,10)||30,this.table?this.table.style.setProperty("--row-height",`${this.rowHeight}px`):document.documentElement.style.setProperty("--row-height",`${this.rowHeight}px`),e&&(this.renderGrid(),this.showToast(`í–‰ ë†’ì´ê°€ ${this.rowHeight}pxë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`,"info"))}setEditMode(t){if(t&&(this.changedRows.newRows.length>0||this.changedRows.updatedRows.length>0||this.changedRows.deletedRows.length>0))return this.showToast("ì €ì¥í•˜ì§€ ì•Šì€ ë³€ê²½ ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € ì €ì¥í•˜ê±°ë‚˜ ì·¨ì†Œí•´ì£¼ì„¸ìš”.","warning"),!1;if(!this.editModeEnabled)return this.showToast("ì´ ê·¸ë¦¬ë“œëŠ” ìˆ˜ì • ëª¨ë“œê°€ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.","warning"),!1;if(this.isEditMode===t)return!1;const e={previousMode:this.isEditMode,newMode:t,cancelled:!1};if(this.emit("beforeEditModeChange",e),e.cancelled)return!1;t&&!this.isEditMode&&(this.originalDataBackup&&0!==this.originalDataBackup.length||(this.originalDataBackup=a(this.originalData))),this.isEditMode=t,this.renderGrid(),this.columns.forEach(t=>{t.sortable&&this.updateSortIndicator(t.field)});const i=t?"ìˆ˜ì • ëª¨ë“œ í™œì„±í™”":"ìˆ˜ì • ëª¨ë“œ ë¹„í™œì„±í™”";return this.showToast(i,"success"),this.emit("afterEditModeChange",{previousMode:e.previousMode,currentMode:t}),!0}isEditModeEnabled(){return this.editModeEnabled}getEditMode(){return this.isEditMode}validateChanges(){if(this.changedRows.newRows.length>0){if(this.changedRows.newRows.some(t=>this.columns.every(e=>{const i=t[e.field];return null==i||""===String(i).trim()})))return this.showToast("ë°ì´í„°ê°€ ì…ë ¥ë˜ì§€ ì•Šì€ í–‰ì´ ìˆìŠµë‹ˆë‹¤. ë‚´ìš©ì„ ì…ë ¥í•˜ê±°ë‚˜ ì‚­ì œ í›„ ì €ì¥í•´ì£¼ì„¸ìš”.","warning"),!1}const t=[...this.changedRows.newRows,...this.changedRows.updatedRows],e={rowsToValidate:t,cancelled:!1};if(this.emit("beforeValidate",e),e.cancelled)return!1;const i=[];for(const e of t)for(const t of this.columns){const s=e[t.field];if(t.editor?.required&&(null==s||""===String(s).trim())){this.showToast(`'${t.title}' í•„ë“œëŠ” í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.`,"error");const n=this.table.querySelector(`tr[data-row-id="${e[this.idField]}"]`),a=n?.querySelector(`td[data-field="${t.field}"]`);a&&(a.classList.add("cell-invalid"),a.querySelector("input, select, textarea")?.focus(),setTimeout(()=>a.classList.remove("cell-invalid"),3e3));const r={rowData:e,column:t,value:s,message:`'${t.title}' í•„ë“œëŠ” í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.`};return i.push(r),this.emit("validationError",r),this.emit("afterValidate",{isValid:!1,errors:i}),!1}if("function"==typeof t.editor?.validate)try{const n=t.editor.validate(s,e,t);if(!0!==n){const a="string"==typeof n?n:`'${t.title}' í•„ë“œì˜ ê°’ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`;this.showToast(a,"error");const r=this.table.querySelector(`tr[data-row-id="${e[this.idField]}"]`),o=r?.querySelector(`td[data-field="${t.field}"]`);o&&(o.classList.add("cell-invalid"),o.querySelector("input, select, textarea")?.focus(),setTimeout(()=>o.classList.remove("cell-invalid"),3e3));const d={rowData:e,column:t,value:s,message:a};return i.push(d),this.emit("validationError",d),this.emit("afterValidate",{isValid:!1,errors:i}),!1}}catch(n){const a=`'${t.title}' ìœ íš¨ì„± ê²€ì‚¬ ì¤‘ ì˜¤ë¥˜: ${n.message}`;console.error(`Validation function error for ${t.field}:`,n),this.showToast(a,"error");const r=this.table.querySelector(`tr[data-row-id="${e[this.idField]}"]`),o=r?.querySelector(`td[data-field="${t.field}"]`);o&&(o.classList.add("cell-invalid"),o.querySelector("input, select, textarea")?.focus(),setTimeout(()=>o.classList.remove("cell-invalid"),3e3));const d={rowData:e,column:t,value:s,message:a};return i.push(d),this.emit("validationError",d),this.emit("afterValidate",{isValid:!1,errors:i}),!1}}return this.emit("afterValidate",{isValid:!0,errors:[]}),!0}printCurrentPage(){const t=this.getSortedData();if(t.length){this.showLoading();try{const e=this.columns.filter(t=>!t.hideColumn&&!this.hiddenColumns.has(t.field)&&!1!==t.print),i=`<table border="1" style="width: 100%; border-collapse: collapse; text-align: center; font-size: 10pt;"><thead><tr style="background: #f0f0f0;"><th style="width: 50px;">ë²ˆí˜¸</th>${e.map(t=>`<th style="${t.width?`width:${t.width};`:""} text-align: ${t.headAlign||"center"}; padding: 6px;">${t.title}</th>`).join("")}</tr></thead><tbody>${t.map((t,i)=>`<tr><td style="padding: 6px;">${i+1}</td>${e.map(e=>{const i=t[e.field]??"";let n=i;e.editor&&"numberbox"===e.editor.type&&(n=s(i,e.editor.decimalPlaces||0));return`<td style="text-align: ${e.cellAlign||("numberbox"===e.editor?.type?"right":"left")}; padding: 6px;">${n}</td>`}).join("")}</tr>`).join("")}</tbody></table>`;this.openPrintWindow(i)}finally{this.hideLoading()}}else this.showToast("ì¸ì‡„í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.","warning")}openPrintWindow(t){const e=window.open("","_blank","width=800,height=600"),i=document.title,s=n();e.document.write(`<html><head><title>ì¸ì‡„</title><style>@media print{@page{margin:1cm}thead{display:table-header-group}}body{font-family:'Malgun Gothic','Arial',sans-serif}h1{text-align:center;margin-bottom:5px;font-size:18pt}.subtitle{text-align:center;color:#666;margin-bottom:20px;font-size:10pt}table{width:100%;border-collapse:collapse;table-layout:fixed}th,td{border:1px solid #ccc;padding:8px;font-size:9pt;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}th{background:#f5f5f5;font-weight:bold}</style></head><body><h1>${i.replace("V4","ì¸ì‡„")}</h1><div class="subtitle">ì¶œë ¥ì¼: ${s}</div>${t}</body></html>`),e.document.close(),e.focus(),setTimeout(()=>e.print(),250)}hideColumn(t){this.hiddenColumns.add(t),this.renderGrid(),this.showToast(`"${this.columns.find(e=>e.field===t)?.title}" ì—´ì´ ìˆ¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.`,"info")}showColumn(t){this.hiddenColumns.delete(t),this.renderGrid(),this.showToast(`"${this.columns.find(e=>e.field===t)?.title}" ì—´ì´ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.`,"info")}showLoading(){this.uiComponents.showLoading()}hideLoading(){this.uiComponents.hideLoading()}showToast(t,e="info"){this.uiComponents.showToast(t,e)}showConfirmModal(t,e){this.uiComponents.showConfirmModal(t,e)}handleError(t,e=""){const i={message:t.message,code:t.code||"UNKNOWN_ERROR",context:e,instanceId:this.instanceId,tableId:this.tableId,timestamp:(new Date).toISOString(),stack:t.stack};this.debugMode&&(console.group(`âŒ SmartGrid Error [${this.tableId}]`),console.error("Error:",t.message),console.log("Context:",e),console.log("Instance:",this.instanceId),console.groupEnd()),this.emit("error",i);const s=this.getUserFriendlyMessage(t);this.showToast(s,"error")}getUserFriendlyMessage(t){return{INVALID_DATA:"ì˜ëª»ëœ ë°ì´í„° í˜•ì‹ì…ë‹ˆë‹¤.",INVALID_COLUMN:"ì˜ëª»ëœ ì»¬ëŸ¼ ì„¤ì •ì…ë‹ˆë‹¤.",RENDER_FAILED:"ê·¸ë¦¬ë“œë¥¼ ë Œë”ë§í•˜ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",VALIDATION_FAILED:"ë°ì´í„° ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",ELEMENT_NOT_FOUND:"í•„ìˆ˜ HTML ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",INITIALIZATION_FAILED:"ê·¸ë¦¬ë“œ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."}[t.code]||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}warn(t,e,i={}){const s={code:t,message:e,details:i,instanceId:this.instanceId,tableId:this.tableId,timestamp:(new Date).toISOString()};this.warnings.push(s),console.warn(`âš ï¸ SmartGrid Warning [${this.tableId}]`,`\n${e}`,i),this.emit("warning",s),this.debugMode&&this.showToast(`[ê²½ê³ ] ${e}`,"warning")}info(t,e={}){this.debugMode&&console.info(`â„¹ï¸ SmartGrid Info [${this.tableId}]`,`\n${t}`,e)}destroy(){this.emit("beforeDestroy"),this.pluginManager?.unregisterAll(),m.instances.delete(this),this.removeAllListeners(),this.uiComponents.destroyAll(),this.wrapper?.remove(),this.renderer.clearTable(),this.table=this.columns=this.originalData=this.currentPageData=this.inputFactory=this.pluginManager=null,console.log(`âœ… SmartGrid ì¸ìŠ¤í„´ìŠ¤ "${this.tableId}" ì œê±° ì™„ë£Œ`),0===m.instances.size&&(m.globalEventsInitialized=!1,console.log("âœ… ëª¨ë“  SmartGrid ì¸ìŠ¤í„´ìŠ¤ ì •ë¦¬ ì™„ë£Œ"))}}var p=Object.freeze({__proto__:null,SmartGrid:m});class f{constructor(t,e={}){if(this.constructor===f)throw new Error("PluginBaseëŠ” ì§ì ‘ ì¸ìŠ¤í„´ìŠ¤í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤");this.grid=t,this.options=e,this.initialized=!1}get name(){throw new Error("name getterëŠ” ë°˜ë“œì‹œ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤")}get version(){return"1.0.0"}install(){this.initialized=!0,this.grid.info(`Plugin "${this.name}" v${this.version} installed`)}uninstall(){this.initialized=!1,this.grid.info(`Plugin "${this.name}" uninstalled`)}isInstalled(){return this.initialized}handleError(t,e=""){this.grid.handleError(t,`${this.name}:${e}`)}log(t,e="info"){const i=`[Plugin:${this.name}]`;switch(e){case"error":console.error(i,t);break;case"warn":console.warn(i,t);break;default:console.log(i,t)}}mergeOptions(t,e){return{...t,...e}}}class w{async handle(t,e,i){const{validData:s,errors:n}=t.validate(e,i);if(n.length>0)return void t.grid.showToast(n[0],"error");const a=i.dataProcessor?i.dataProcessor(s):s;t.bind(a,i),t.grid.showToast("ì—‘ì…€ ë°ì´í„°ê°€ ê·¸ë¦¬ë“œì— ì„±ê³µì ìœ¼ë¡œ ë°”ì¸ë”©ë˜ì—ˆìŠµë‹ˆë‹¤.","success")}}class b{async handle(t,e,i){const{validData:s,errors:n}=t.validate(e,i);if(n.length>0)return void t.grid.showToast(n[0],"error");const a=i.dataProcessor?i.dataProcessor(s):s,r=t.mapData(a,i);t.grid.showConfirmModal(`ì´ ${r.length}ê±´ì˜ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,async e=>{e&&await t.sendToServer(r,i)})}}class y extends f{constructor(t,e={}){super(t,e);const i={columnMap:this.generateColumnMap(),validationRules:this.generateValidationRules(),dataProcessor:null};this.options=this.mergeOptions(i,e)}get name(){return"excel"}get version(){return"1.0.0"}install(){super.install(),this.grid.on("beforeDestroy",()=>this.uninstall())}async upload(t,e={}){try{this.log(`Uploading file: ${t.name}`);const i=this.mergeOptions(this.options,e),s=await this.parse(t),n="direct"===i.mode?new b:new w;await n.handle(this,s,i),this.log("Upload completed successfully")}catch(t){throw this.handleError(t,"upload"),t}}async download(t="grid_data.xlsx"){try{this.log(`Downloading file: ${t}`);const e=this.grid.getData();if(0===e.length)return void this.grid.showToast("ë‹¤ìš´ë¡œë“œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.","info");const i=this.prepareExportData(e);if("undefined"==typeof XLSX)throw new Error("XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");const s=XLSX.utils.json_to_sheet(i),n=XLSX.utils.book_new();XLSX.utils.book_append_sheet(n,s,"Sheet1"),XLSX.writeFile(n,t),this.grid.showToast("ì—‘ì…€ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.","success"),this.log("Download completed successfully")}catch(t){throw this.handleError(t,"download"),t}}async send(t={}){try{const e=this.grid.getData();if(!e||0===e.length)return void this.grid.showToast("ì „ì†¡í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.","warning");!0===t.skipConfirm?await this.sendToServer(e,t):this.grid.showConfirmModal(`ì´ ${e.length}ê±´ì˜ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,async i=>{i&&await this.sendToServer(e,t)})}catch(t){throw this.handleError(t,"send"),t}}async parse(t){return new Promise((e,i)=>{const s=new FileReader;s.onload=()=>{try{if("undefined"==typeof XLSX)throw new Error("XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");const t=XLSX.read(s.result,{type:"array",cellDates:!0,raw:!1,dateNF:"yyyy-mm-dd"}),i=t.SheetNames[0],n=t.Sheets[i],a=XLSX.utils.sheet_to_json(n,{header:1,range:0,raw:!1})[0];if(!a||0===a.length)throw new Error("ì—‘ì…€ íŒŒì¼ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.");const r=XLSX.utils.sheet_to_json(n,{header:a,defval:"",raw:!1,range:1});this.log(`Parsed ${r.length} rows from Excel file`),e(r)}catch(t){i(t)}},s.onerror=t=>i(t),s.readAsArrayBuffer(t)})}validate(t,e){const i=[],s=[],{validationRules:n}=e;for(const[e,a]of t.entries()){const t=[];for(const e in n)if(n[e].required){const i=a[e];null!=i&&""!==String(i).trim()||t.push(`'${e}'`)}if(t.length>0){s.push(`${e+2}í–‰ì—ì„œ ${t.join(", ")} í•„ë“œì˜ ê°’ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.`);break}i.push(a)}return{validData:i,errors:s}}mapData(t,e){const{columnMap:i}=e;return t.map(t=>{const e={};for(const s in i)void 0!==t[s]&&(e[i[s]]=t[s]);return e})}bind(t,e){const i=this.mapData(t,e);"function"==typeof this.grid.applyFormula&&i.forEach(t=>this.grid.applyFormula(t)),this.grid.invalidateSortCache(),"server"===this.grid.pagingMode?(this.grid.currentPageData=i,this.grid.totalRows=i.length,this.grid.currentPage=1,this.grid.renderGrid(),this.grid.renderPagination(),this.grid.updateTotalRowsInfo()):(this.grid.originalData=i,this.grid.totalRows=i.length,this.grid.currentPage=1,this.grid.currentPageData=i.slice(0,this.grid.pageSize),this.grid.renderGrid(),this.grid.renderPagination(),this.grid.updateTotalRowsInfo()),this.log(`Bound ${i.length} rows to grid`)}async sendToServer(t,e){if(!t||0===t.length)return void this.grid.showToast("ì „ì†¡í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.","info");const i=e.url||"/";this.log(`Sending ${t.length} rows to ${i}`),this.grid.showLoading();try{const s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error(`Server response error: ${s.status}`);const n=await s.json();return this.grid.showToast("ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.","success"),this.log("Data sent successfully"),!0===e.clearAfterSend&&(this.grid.loadData([]),this.log("Grid cleared after send")),n}catch(t){throw this.log(`Send failed: ${t.message}`,"error"),this.grid.showToast("ì„œë²„ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","error"),t}finally{this.grid.hideLoading()}}generateColumnMap(){return this.grid.columns.reduce((t,e)=>(e.title&&e.field&&(t[e.title]=e.field),t),{})}generateValidationRules(){return this.grid.columns.reduce((t,e)=>(e.title&&e.editor?.required&&(t[e.title]={required:!0}),t),{})}prepareExportData(t){return t.map(t=>{const e={};return this.grid.columns.forEach(i=>{i.hideColumn||!1===i.exportExcel||(e[i.title]=t[i.field])}),e})}}var v=Object.freeze({__proto__:null,GridExcelPlugin:y});class E extends f{constructor(t,e={}){super(t,e);const i={defaultChartType:"bar",modalTitle:"ë°ì´í„° ì°¨íŠ¸",chartLibrary:window.Chart};this.options=this.mergeOptions(i,e),this.chartModalElement=null,this.chartInstance=null,this.boundHideModal=this._hideModal.bind(this)}get name(){return"chart"}get version(){return"1.2.1"}install(){super.install(),this.createChartModal(),this.grid.on("beforeDestroy",()=>this.uninstall())}uninstall(){this.chartModalElement?.remove(),this.chartModalElement=null,this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null),super.uninstall()}showChart(t={}){if(!this.options.chartLibrary){const t="Chart.js ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. (window.Chartê°€ ì—†ìŠµë‹ˆë‹¤)";return this.handleError(new Error(t),"showChart"),void this.grid.showToast(t,"error")}if(this.chartModalElement)try{const e=t.type||this.options.defaultChartType,i=t.title||this.options.modalTitle,s=this.generateChartData(t);if(!s)return;const n=this.chartModalElement.querySelector(".smartgrid-modal-title");n&&(n.textContent=i);const a=this.chartModalElement.querySelector("canvas");if(!a)return void this.handleError(new Error("ëª¨ë‹¬ì—ì„œ Canvas ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),"showChart");this.renderChart(a,e,s,t.chartOptions||{}),this.chartModalElement.classList.add("show")}catch(t){this.handleError(t,"showChart"),this.grid.showToast("ì°¨íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","error")}else this.handleError(new Error("ì°¨íŠ¸ ëª¨ë‹¬ì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."),"showChart")}hideChart(){this._hideModal()}createChartModal(){if(this.chartModalElement)return;const t=document.createElement("div");t.id=`${this.grid.instanceId}_chartModal`,t.className="smartgrid-modal smartgrid-chart-modal",t.setAttribute("data-instance",this.grid.instanceId),t.innerHTML=`\n      <div class="smartgrid-modal-backdrop" data-instance="${this.grid.instanceId}"></div>\n      <div class="smartgrid-modal-content" data-instance="${this.grid.instanceId}" style="max-width: 800px; width: 90%;">\n        <div class="smartgrid-modal-header">\n          <h5 class="smartgrid-modal-title">${this.options.modalTitle}</h5>\n          <button class="smartgrid-modal-close" data-instance="${this.grid.instanceId}">&times;</button>\n        </div>\n        <div class="smartgrid-modal-body" style="padding: 1rem; max-height: 70vh; overflow-y: auto;">\n          <canvas id="${this.grid.instanceId}_chartCanvas"></canvas>\n        </div>\n        <div class="smartgrid-modal-footer">\n          <button class="smartgrid-btn smartgrid-btn-secondary" data-dismiss="modal" data-instance="${this.grid.instanceId}">ë‹«ê¸°</button>\n        </div>\n      </div>\n    `,document.body.appendChild(t),this.chartModalElement=t;t.querySelectorAll('\n      [data-dismiss="modal"],\n      .smartgrid-modal-close,\n      .smartgrid-modal-backdrop\n    ').forEach(t=>{t.addEventListener("click",this.boundHideModal)})}_hideModal(){this.chartModalElement&&this.chartModalElement.classList.remove("show"),this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null)}generateChartData(t){const{labelField:e,dataFields:i,groupBy:s}=t;if(!i||Array.isArray(i)&&0===i.length||"string"!=typeof i&&!Array.isArray(i))return this.grid.showToast("ì°¨íŠ¸ ë°ì´í„° í•„ë“œ(dataFields)ê°€ ì§€ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.","warning"),null;const n=this.grid.getRows();if(0===n.length)return this.grid.showToast("ì°¨íŠ¸ë¥¼ ìƒì„±í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.","info"),null;const a=Array.isArray(i)?i:[i];let r=[],o=[];if(s){const t=new Map;n.forEach(e=>{const i=e[s]||"ë¯¸ë¶„ë¥˜";if(!t.has(i)){const e={};a.forEach(t=>{e[t]=0}),t.set(i,e)}const n=t.get(i);a.forEach(t=>{n[t]+=parseFloat(e[t])||0})}),r=Array.from(t.keys()),o=a.map(e=>{const i=this.grid.columns.find(t=>t.field===e);return{label:i?i.title:e,data:r.map(i=>t.get(i)[e])}})}else r=n.map(t=>e?t[e]:""),o=a.map(t=>{const e=this.grid.columns.find(e=>e.field===t);return{label:e?e.title:t,data:n.map(e=>parseFloat(e[t])||0)}});return{labels:r,datasets:o}}renderChart(t,e,i,s={}){this.chartInstance&&this.chartInstance.destroy();const n=this.options.chartLibrary;try{this.chartInstance=new n(t,{type:e,data:i,options:this.mergeOptions({responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"top"},title:{display:!1}}},s)})}catch(t){this.handleError(t,"renderChart"),this.grid.showToast(`ì°¨íŠ¸ ë Œë”ë§ ì‹¤íŒ¨: ${t.message}`,"error")}}}var C=Object.freeze({__proto__:null,GridChartPlugin:E});return"undefined"!=typeof window&&(Promise.resolve().then(function(){return p}).then(t=>{window.SmartGrid=t.SmartGrid}),Promise.resolve().then(function(){return v}).then(t=>{window.GridExcelPlugin=t.GridExcelPlugin}),Promise.resolve().then(function(){return C}).then(t=>{window.GridChartPlugin=t.GridChartPlugin})),t.ClientSideHandler=o,t.DataHandler=r,t.EventEmitter=e,t.GridChartPlugin=E,t.GridEvents=u,t.GridExcelPlugin=y,t.GridRenderer=h,t.InputFactory=l,t.PluginBase=f,t.ServerSideHandler=d,t.SmartGrid=m,t.SmartGridError=i,t.UIComponents=c,t.createSvgUse=function(t){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("width","16"),e.setAttribute("height","16");const i=document.createElementNS("http://www.w3.org/2000/svg","use");return i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t),e.appendChild(i),e.outerHTML},t.deepClone=a,t.default=m,t.formatNumber=s,t.getCurrentDateTime=n,t.isEmpty=function(t){return 0===Object.keys(t).length},t.sleep=function(t){return new Promise(e=>setTimeout(e,t))},t.stripHtml=function(t){const e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""},Object.defineProperty(t,"__esModule",{value:!0}),t}({});
