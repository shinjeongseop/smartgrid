var smartGrid=(()=>{var k=Object.defineProperty;var ot=Object.getOwnPropertyDescriptor;var dt=Object.getOwnPropertyNames;var lt=Object.prototype.hasOwnProperty;var ct=(h,e,t)=>e in h?k(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var w=(h,e)=>()=>(h&&(e=h(h=0)),e);var O=(h,e)=>{for(var t in e)k(h,t,{get:e[t],enumerable:!0})},ht=(h,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of dt(e))!lt.call(h,s)&&s!==t&&k(h,s,{get:()=>e[s],enumerable:!(i=ot(e,s))||i.enumerable});return h};var ut=h=>ht(k({},"__esModule",{value:!0}),h);var u=(h,e,t)=>ct(h,typeof e!="symbol"?e+"":e,t);var v,B=w(()=>{v=class{constructor(){u(this,"events",new Map);u(this,"maxListeners",10)}on(e,t){if(typeof t!="function")throw new TypeError("Listener must be a function");this.events.has(e)||this.events.set(e,[]);let i=this.events.get(e);return i.length>=this.maxListeners&&console.warn(`Possible EventEmitter memory leak detected. ${i.length+1} ${e} listeners added. Use setMaxListeners() to increase limit`),i.push(t),()=>this.off(e,t)}once(e,t){let i=(...s)=>{t(...s),this.off(e,i)};return i.listener=t,this.on(e,i)}off(e,t){if(!this.events.has(e))return!1;let i=this.events.get(e),s=i.findIndex(r=>r===t||r.listener===t);return s!==-1?(i.splice(s,1),i.length===0&&this.events.delete(e),!0):!1}emit(e,...t){if(!this.events.has(e))return!1;let i=[...this.events.get(e)];for(let s of i)try{s(...t)}catch(r){console.error(`Error in event listener for "${e}":`,r),this.emit("error",{eventName:e,error:r,listener:s})}return!0}removeAllListeners(e){return e?this.events.delete(e):(this.events.clear(),!0)}listenerCount(e){return this.events.get(e)?.length??0}eventNames(){return Array.from(this.events.keys())}setMaxListeners(e){return this.maxListeners=e,this}getMaxListeners(){return this.maxListeners}}});var y,z=w(()=>{y=class extends Error{constructor(e,t,i,s={}){super(e),this.name="SmartGridError",this.code=t,this.instanceId=i,this.details=s,this.timestamp=new Date().toISOString()}}});function E(h,e=0){if(h==null||h==="")return"";let t=parseFloat(h);return isNaN(t)?String(h):t.toLocaleString("ko-KR",{minimumFractionDigits:e,maximumFractionDigits:e})}function Y(h){let e=document.createElement("div");return e.innerHTML=h,e.textContent||e.innerText||""}function F(){return new Date().toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"-").replace(".","")}function Q(h){let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("width","16"),e.setAttribute("height","16");let t=document.createElementNS("http://www.w3.org/2000/svg","use");return t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h),e.appendChild(t),e.outerHTML}function tt(h){return new Promise(e=>setTimeout(e,h))}function b(h){return structuredClone(h)}function et(h){return Object.keys(h).length===0}var I=w(()=>{});var R,C,S,V=w(()=>{z();I();R=class h{constructor(e){if(this.constructor===h)throw new TypeError('Abstract class "DataHandler" cannot be instantiated directly.');this.grid=e}async load(e){throw new Error('Method "load" must be implemented.')}async page(){throw new Error('Method "page" must be implemented.')}async sort(){throw new Error('Method "sort" must be implemented.')}async add(){throw new Error('Method "add" must be implemented.')}async save(){throw new Error('Method "save" must be implemented.')}async reject(){throw new Error('Method "reject" must be implemented.')}async delete(){throw new Error('Method "delete" must be implemented.')}getSortedData(){throw new Error('Method "getSortedData" must be implemented.')}updateTotalRowsInfo(){throw new Error('Method "updateTotalRowsInfo" must be implemented.')}},C=class extends R{constructor(t){super(t);u(this,"sortedDataCache",null);u(this,"sortCacheKey",null);this.grid.pagingMode="client"}async load(t){let{grid:i}=this;try{if(!Array.isArray(t))throw new y("\uB370\uC774\uD130\uB294 \uBC30\uC5F4 \uD615\uC2DD\uC774\uC5B4\uC57C \uD569\uB2C8\uB2E4.","INVALID_DATA",i.instanceId,{dataType:typeof t});i.info("\uB370\uC774\uD130 \uB85C\uB4DC \uC2DC\uC791",{rowCount:t.length}),t.length>1e4&&i.warn("LARGE_DATASET",`\uB300\uC6A9\uB7C9 \uB370\uC774\uD130(${t.length}\uD589)\uAC00 \uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`);let s=b(t);return i.options.loadFilter&&(s=i.options.loadFilter(s)),s.forEach(r=>i.applyFormula(r)),i.originalData=s,i.originalDataBackup=b(i.originalData),i.totalRows=i.originalData.length,i.currentPage=1,this.sortedDataCache=null,this.sortCacheKey=null,i.options.isEditMode&&(i.isEditMode=!0),this.page(),i.emit("afterLoad",{data:i.originalData,totalRows:i.totalRows}),i.options.onLoadSuccess?.(i.originalData,i.totalRows,i),i.originalData}catch(s){throw i.handleError(s,"loadData"),i.emit("loadError",{error:s}),i.options.onLoadError?.(s,i),i.originalData=[],i.totalRows=0,this.sortedDataCache=null,this.sortCacheKey=null,this.page(),s}}page(){let{grid:t}=this,i=this.getSortedData();t.totalRows=i.length;let s=(t.currentPage-1)*t.pageSize,r=s+t.pageSize;if(t.currentPageData=i.slice(s,r),t.currentPageData.length===0&&t.totalRows>0)return t.currentPage=Math.ceil(t.totalRows/t.pageSize)||1,this.page();t.renderGrid(),t.renderPagination(),this.updateTotalRowsInfo()}sort(){this.invalidateSortCache(),this.grid.currentPage=1,this.page(),this.grid.columns.forEach(t=>this.grid.updateSortIndicator(t.field))}add(){let{grid:t}=this;if(t.isEditMode){t.showToast("\uC218\uC815 \uBAA8\uB4DC\uC5D0\uC11C\uB294 \uD589\uC744 \uCD94\uAC00\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. \uBA3C\uC800 \uC800\uC7A5\uD558\uAC70\uB098 \uCDE8\uC18C\uD574\uC8FC\uC138\uC694.","warning");return}if(t.changedRows.newRows.length>0){t.showToast("\uBA3C\uC800 \uCD94\uAC00\uB41C \uD589\uC744 \uC800\uC7A5\uD574\uC8FC\uC138\uC694.","warning");return}t.emit("beforeRowAdd",{cancelled:!1}),(!t.originalDataBackup||t.originalDataBackup.length===0)&&(t.originalDataBackup=b(t.originalData));let i=t.columns.reduce((s,r,n)=>{if(r.formula)s[r.field]=t.evaluateFormula(r.formula,s,n);else{let a=r.editor?.defaultVal,d;if(typeof a=="function")try{d=a(r,t)}catch(o){console.error(`defaultVal \uD568\uC218 \uC2E4\uD589 \uC911 \uC624\uB958 (\uD544\uB4DC: ${r.field}):`,o),d=void 0}d===void 0&&(r.editor?.type==="selectbox"||r.editor?.type==="radiobutton")&&Array.isArray(r.editor.options)&&r.editor.options.length>0&&(d=r.editor.options[0].val),s[r.field]=d??""}return s},{[t.idField]:`new_${Date.now()}`});t.originalData.unshift(i),t.changedRows.newRows.push(i),this.invalidateSortCache(),t.currentPage=1,this.page(),t.emit("afterRowAdd",{row:i}),t.showToast("\uC0C8 \uD589\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","success")}async save(){let{grid:t}=this;if(!t.validateChanges())return;let{newRows:i,updatedRows:s,deletedRows:r}=t.changedRows;if(i.length===0&&s.length===0&&r.length===0){t.showToast("\uBCC0\uACBD\uB41C \uB0B4\uC6A9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.","info");return}let n={changes:b(t.changedRows),cancelled:!1};if(t.emit("beforeSave",n),!n.cancelled)try{t.showToast(`\uCD1D ${i.length}\uAC1C \uCD94\uAC00, ${s.length}\uAC1C \uC218\uC815, ${r.length}\uAC1C \uC0AD\uC81C \uC644\uB8CC`,"success"),t.changedRows={newRows:[],updatedRows:[],deletedRows:[]},t.originalDataBackup=[],t.emit("afterSave",{changes:n.changes}),t.isEditMode?t.setEditMode(!1):t.renderGrid()}catch(a){t.emit("saveError",{error:a,changes:t.changedRows}),t.showToast("\uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","error")}}async reject(){let{grid:t}=this;t.showConfirmModal("\uBAA8\uB4E0 \uBCC0\uACBD \uC0AC\uD56D\uC744 \uCDE8\uC18C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",i=>{if(i){let s={changes:b(t.changedRows),cancelled:!1};if(t.emit("beforeCancel",s),s.cancelled)return;t.originalDataBackup&&t.originalDataBackup.length>0&&(t.originalData=b(t.originalDataBackup)),t.changedRows={newRows:[],updatedRows:[],deletedRows:[]},t.originalDataBackup=[],t.isEditMode&&(t.isEditMode=!1),this.invalidateSortCache(),this.page(),t.emit("afterCancel",{}),t.showToast("\uBAA8\uB4E0 \uBCC0\uACBD \uC0AC\uD56D\uC774 \uCDE8\uC18C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","info")}})}async delete(){let{grid:t}=this,i=t.currentPageData.filter(s=>s.checked);if(i.length===0){t.showToast("\uC0AD\uC81C\uD560 \uD589\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.","warning");return}t.showConfirmModal(`\uC120\uD0DD\uB41C ${i.length}\uAC1C\uC758 \uD589\uC744 \uC989\uC2DC \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C? (\uC774 \uC791\uC5C5\uC740 \uB418\uB3CC\uB9B4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4)`,s=>{if(s){let r={rows:[...i],cancelled:!1};if(t.emit("beforeRowDelete",r),r.cancelled)return;let n=new Set(i.map(a=>a[t.idField]));t.changedRows.newRows=t.changedRows.newRows.filter(a=>!n.has(a[t.idField])),t.changedRows.updatedRows=t.changedRows.updatedRows.filter(a=>!n.has(a[t.idField])),t.originalData=t.originalData.filter(a=>!n.has(a[t.idField])),this.invalidateSortCache(),this.page(),t.emit("afterRowDelete",{rows:i}),t.showToast(`${i.length}\uAC1C\uC758 \uD589\uC774 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,"success")}})}getSortedData(){let{grid:t}=this,s=JSON.stringify(t.sortOrders);if(this.sortCacheKey===s&&this.sortedDataCache)return[...this.sortedDataCache];let r=[...t.originalData];return t.sortOrders.length>0&&r.sort(t.compareRowsForSort.bind(t)),this.sortedDataCache=r,this.sortCacheKey=s,[...r]}updateTotalRowsInfo(){let{grid:t}=this;if(!t.options.enableTotalRows||!t.totalRowsElement)return;let i=t.originalData.length;t.totalRowsElement.textContent=`\uC804\uCCB4 \uB370\uC774\uD130: ${i}\uAC1C`}invalidateSortCache(){this.sortedDataCache=null,this.sortCacheKey=null}},S=class extends R{constructor(e){if(super(e),this.grid.pagingMode="server",!this.grid.options.url)throw new y("\uC11C\uBC84 URL\uC774 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.","INVALID_DATA",this.grid.instanceId)}async load(){let{grid:e}=this;e.showLoading();try{let t={params:e.lastParams,cancelled:!1};if(e.emit("beforeLoad",t),t.cancelled)return;let i={...e.options.queryParams,page:e.currentPage,pageSize:e.pageSize,sortOrders:e.sortOrders,...e.lastParams},s=await fetch(e.options.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!s.ok)throw new y(`\uC11C\uBC84 \uC751\uB2F5 \uC624\uB958: ${s.status} ${s.statusText}`,"INVALID_DATA",e.instanceId);let r=await s.json();if(!r.success)throw new y(r.error||"\uC11C\uBC84 \uCC98\uB9AC \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","INVALID_DATA",e.instanceId);let n=e.options.loadFilter?e.options.loadFilter(r):r,a=n.rows??n.data??(Array.isArray(n)?n:[]),d=n.total??n.count??a.length;return a.forEach(o=>e.applyFormula(o)),e.originalData=a,e.totalRows=d,e.currentPageData=a,e.renderGrid(),e.renderPagination(),this.updateTotalRowsInfo(),e.columns.forEach(o=>e.updateSortIndicator(o.field)),e.emit("afterLoad",{data:a,totalRows:d}),e.options.onLoadSuccess?.(a,d,e),a}catch(t){throw e.handleError(t,"fetchData"),e.emit("loadError",{error:t}),e.options.onLoadError?.(t,e),e.renderGrid(),t}finally{await new Promise(t=>setTimeout(t,300)),e.hideLoading()}}async page(){await this.load()}async add(){let{grid:e}=this;if(e.isEditMode){e.showToast("\uC218\uC815 \uBAA8\uB4DC\uC5D0\uC11C\uB294 \uD589\uC744 \uCD94\uAC00\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. \uBA3C\uC800 \uC800\uC7A5\uD558\uAC70\uB098 \uCDE8\uC18C\uD574\uC8FC\uC138\uC694.","warning");return}let t={cancelled:!1};if(e.emit("beforeRowAdd",t),t.cancelled)return;let i=e.columns.reduce((s,r)=>{if(r.formula)s[r.field]=e.evaluateFormula(r.formula,s,r);else{let n=r.editor?.defaultVal,a;if(typeof n=="function")try{a=n(r,this.grid)}catch(d){console.error(`defaultVal \uD568\uC218 \uC2E4\uD589 \uC911 \uC624\uB958 (\uD544\uB4DC: ${r.field}):`,d),a=void 0}a===void 0&&(r.editor?.type==="selectbox"||r.editor?.type==="radiobutton")&&Array.isArray(r.editor.options)&&r.editor.options.length>0&&(a=r.editor.options[0].val),s[r.field]=a??""}return s},{[e.idField]:`new_${Date.now()}`});e.currentPageData.unshift(i),e.changedRows.newRows.push(i),e.renderGrid(),e.emit("afterRowAdd",{row:i}),e.showToast("\uC0C8 \uD589\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uC800\uC7A5 \uC2DC \uC11C\uBC84\uC5D0 \uBC18\uC601\uB429\uB2C8\uB2E4.","success")}async sort(){this.grid.currentPage=1,await this.load()}async save(){let{grid:e}=this,t="saveToServer";try{let{newRows:i,updatedRows:s,deletedRows:r}=e.changedRows;if(i.length===0&&s.length===0&&r.length===0){e.showToast("\uBCC0\uACBD\uB41C \uB0B4\uC6A9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.","info");return}if(!e.validateChanges())return;let n={changes:b(e.changedRows),cancelled:!1};if(e.emit("beforeSave",n),n.cancelled)return;e.showLoading();let a={inserted:0,updated:0,deleted:0,errors:[]},{writeUrl:d,updateUrl:o,deleteUrl:l}=e.options;if(i.length>0&&d)try{let c=await this.sendRequest(d,i);a.inserted=c.inserted??i.length}catch(c){a.errors.push({type:"insert",error:c.message})}if(s.length>0&&o)try{let c=await this.sendRequest(o,s);a.updated=c.updated??s.length,e.isEditMode=!1}catch(c){a.errors.push({type:"update",error:c.message})}if(r.length>0&&l)try{let c=r.map(f=>f[e.idField]),g=await this.sendRequest(l,c);a.deleted=g.deleted??r.length}catch(c){a.errors.push({type:"delete",error:c.message})}if(e.hideLoading(),a.errors.length>0){let c=a.errors.map(g=>`${g.type}: ${g.error}`).join(`
`);e.showToast(`\uC77C\uBD80 \uC791\uC5C5\uC774 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.
${c}`,"error"),e.emit("saveError",{results:a})}else e.showToast(`\uCD1D ${a.inserted}\uAC1C \uCD94\uAC00, ${a.updated}\uAC1C \uC218\uC815, ${a.deleted}\uAC1C \uC0AD\uC81C \uC644\uB8CC`,"success"),e.changedRows={newRows:[],updatedRows:[],deletedRows:[]},e.originalDataBackup=[],e.emit("afterSave",{results:a}),await this.load()}catch(i){e.handleError(i,t),e.emit("saveError",{error:i}),e.showToast("\uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","error")}}async sendRequest(e,t){let i=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw new Error(`Request failed with status ${i.status}`);let s=await i.json();if(!s.success)throw new Error(s.error||"Request failed");return s}async reject(){let{grid:e}=this;e.showConfirmModal("\uBAA8\uB4E0 \uBCC0\uACBD \uC0AC\uD56D\uC744 \uCDE8\uC18C\uD558\uACE0 \uC11C\uBC84\uC5D0\uC11C \uB370\uC774\uD130\uB97C \uB2E4\uC2DC \uBD88\uB7EC\uC624\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",t=>{if(t){let i={changes:b(e.changedRows),cancelled:!1};if(e.emit("beforeCancel",i),i.cancelled)return;e.changedRows={newRows:[],updatedRows:[],deletedRows:[]},e.originalDataBackup=[],e.isEditMode&&(e.isEditMode=!1),this.load(),e.emit("afterCancel",{}),e.showToast("\uBAA8\uB4E0 \uBCC0\uACBD \uC0AC\uD56D\uC774 \uCDE8\uC18C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","info")}})}async delete(){let{grid:e}=this,t=e.currentPageData.filter(i=>i.checked);if(t.length===0){e.showToast("\uC0AD\uC81C\uD560 \uD589\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.","warning");return}e.showConfirmModal(`\uC120\uD0DD\uB41C ${t.length}\uAC1C\uC758 \uD589\uC744 \uC11C\uBC84\uC5D0\uC11C \uC989\uC2DC \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C? (\uC774 \uC791\uC5C5\uC740 \uB418\uB3CC\uB9B4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4)`,async i=>{if(i){let s={rows:[...t],cancelled:!1};if(e.emit("beforeRowDelete",s),s.cancelled)return;let r=t.map(n=>n[e.idField]);if(!e.options.deleteUrl){e.showToast("\uC0AD\uC81C\uB97C \uCC98\uB9AC\uD560 \uC11C\uBC84 URL\uC774 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.","error");return}e.showLoading();try{let n=await fetch(e.options.deleteUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:r})});if(!n.ok)throw new Error(`\uC11C\uBC84 \uC751\uB2F5 \uC624\uB958: ${n.status}`);let a=await n.json();if(a.success)e.showToast(`${a.deleted}\uAC1C\uC758 \uD589\uC774 \uC131\uACF5\uC801\uC73C\uB85C \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,"success"),e.emit("afterRowDelete",{rows:t,result:a}),await this.load();else throw new Error(a.error||"\uC11C\uBC84\uC5D0\uC11C \uC0AD\uC81C \uCC98\uB9AC\uB97C \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}catch(n){e.handleError(n,"immediateDelete"),e.showToast("\uC0AD\uC81C \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","error")}finally{e.hideLoading()}}})}getSortedData(){return[...this.grid.currentPageData]}updateTotalRowsInfo(){let{grid:e}=this;!e.options.enableTotalRows||!e.totalRowsElement||(e.totalRowsElement.textContent=`\uC804\uCCB4 \uB370\uC774\uD130: ${e.totalRows}\uAC1C`)}}});var T,G=w(()=>{T=class{constructor(e){this.grid=e,this.selectOptionCache=new Map,this.inputConfigs={textbox:{type:"text",class:"smartgrid-input smartgrid-input-text"},email:{type:"email",class:"smartgrid-input smartgrid-input-email"},datebox:{type:"date",class:"smartgrid-input smartgrid-input-date"}},this.creators={numberbox:this.createNumberInput.bind(this),checkbox:this.createCheckboxInput.bind(this),selectbox:this.createSelectInput.bind(this),radiobutton:this.createRadioInput.bind(this)},Object.keys(this.inputConfigs).forEach(t=>{this.creators[t]=(i,s,r)=>this.createStandardInput(t,i,s,r)})}create(e,t,i){let s=e.editor.type||"textbox",r=this.creators[s];return r?r(e,t,i):(console.warn(`'${s}' \uD0C0\uC785\uC758 \uC5D0\uB514\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC5B4 textbox\uB85C \uB300\uCCB4\uD569\uB2C8\uB2E4.`),this.createStandardInput("textbox",e,t,i))}CommonAttributes(e,t){let{editor:i}=t;i.placeholder&&(e.placeholder=i.placeholder),i.required&&(e.required=i.required),i.multiple&&(e.multiple=i.multiple),i.disabled&&(e.disabled=i.disabled),i.readonly&&(e.readOnly=i.readonly)}getDefault(e,t,i){let s=e.editor,r="";typeof s.defaultVal=="function"?r=s.defaultVal(e,this.grid)??"":s.defaultVal!==void 0&&s.defaultVal!==null&&(r=s.defaultVal);let n=i!=null&&i!==""?i:r;return e.formula&&(n==null||n===isNaN)&&(s.type==="numberbox"||typeof e.formula=="function"?n=0:n=""),n}createStandardInput(e,t,i,s){let r=this.inputConfigs[e],n=document.createElement("input");n.type=r.type,n.value=s??"",n.className=r.class,n.setAttribute("data-editor-type",e),this.CommonAttributes(n,t);let a=this.getDefault(t,i,s);return n.value=a,i[t.field]=a,n}createNumberInput(e,t,i){let s=document.createElement("input");s.type="number",s.step="any";let r=e.editor.decimalPlaces??0,n=i!=null&&i!==""?Number(i).toFixed(r):0;s.value=n,s.className="smartgrid-input smartgrid-input-number",e.editor.min!==void 0&&(s.min=e.editor.min),e.editor.max!==void 0&&(s.max=e.editor.max),e.editor.step!==void 0&&(s.step=e.editor.step),s.setAttribute("data-editor-type","numberbox"),this.CommonAttributes(s,e);let a=this.getDefault(e,t,i);return s.value=a!==""?Number(a):"",t[e.field]=s.value,s}createCheckboxInput(e,t,i){let s=document.createElement("div");s.className="smartgrid-d-flex smartgrid-justify-content-center smartgrid-align-items-center";let r=document.createElement("input");r.type="checkbox",r.className="smartgrid-input-checkbox",r.setAttribute("data-editor-type","checkbox"),this.CommonAttributes(r,e);let n=this.getDefault(e,t,i);return r.checked=!!n,t[e.field]=r.checked?1:0,s.appendChild(r),s}createSelectInput(e,t,i){let s=document.createElement("select");s.className="smartgrid-input-select",s.setAttribute("data-editor-type","selectbox"),this.CommonAttributes(s,e);let r=e.editor,n=r.valueField||"value",a=r.textField||"text",d=r.url,o="";typeof r.defaultVal=="function"?o=r.defaultVal(e,this.grid)??"":r.defaultVal!==void 0&&r.defaultVal!==null&&(o=r.defaultVal);let l=g=>{let f=g.length>0?g[0][n]:"",p=i!=null&&i!==""?i:o!==""?o:f;s.value=p,t[e.field]=s.value},c=g=>{if(s.innerHTML="",!Array.isArray(g))throw new Error(`URL(${d})\uC740 \uBC30\uC5F4\uC744 \uBC18\uD658\uD574\uC57C \uD569\uB2C8\uB2E4.`);return g.forEach(f=>{let p=document.createElement("option");p.value=f[n],p.textContent=f[a],s.appendChild(p)}),g};if(d&&typeof d=="string"){s.disabled=!0,s.innerHTML="<option>\uB85C\uB529 \uC911...</option>";let g=this.selectOptionCache.get(d);return g||(g=fetch(d).then(f=>{if(!f.ok)throw new Error(`Selectbox \uC635\uC158 \uB85C\uB4DC \uC2E4\uD328: ${f.status}`);return f.json()}).catch(f=>{throw this.selectOptionCache.delete(d),f}),this.selectOptionCache.set(d,g)),g.then(c).then(f=>{l(f),s.disabled=!1}).catch(f=>{this.grid?.handleError?.(f,`createSelectInput.fetch(${d})`),s.innerHTML="<option>\uB85C\uB4DC \uC2E4\uD328</option>"}),s}if(Array.isArray(r.options)){let g=r.options;return g.forEach(f=>{let p=document.createElement("option");p.value=f[n],p.textContent=f[a],s.appendChild(p)}),l(g),s}return s.innerHTML="<option>\uC635\uC158 \uC5C6\uC74C</option>",s}createRadioInput(e,t,i){let s=document.createElement("div");s.className="smartgrid-d-flex smartgrid-align-items-center",s.style.cssText="height: 100%; justify-content: flex-start; padding: 0 8px; flex-wrap: wrap;";let r=`radio_${e.field}_${t[this.grid.idField]}`;return(e.editor.options||[]).forEach(n=>{let a=`${r}_${n.val}`,d=document.createElement("div");d.style.cssText="display: inline-flex; align-items: center; margin-right: 12px; margin: 0;";let o=document.createElement("input");o.type="radio",o.id=a,o.name=r,o.value=n.val,o.className="smartgrid-input-radio",o.checked=String(n.val)===String(i),o.setAttribute("data-editor-type","radiobutton"),this.CommonAttributes(o,e);let l=document.createElement("label");l.className="smartgrid-input-radio-label",l.setAttribute("for",a),l.textContent=n.text,d.appendChild(o),d.appendChild(l),s.appendChild(d)}),s}createTextareaInput(e,t,i){let s=document.createElement("textarea");s.value=i??"",s.className="smartgrid-input-textarea",s.style.cssText="width: 100%; box-sizing: border-box; resize: none;",s.style.height="calc(var(--row-height, 30px) - 8px)",s.setAttribute("data-editor-type","textarea"),this.CommonAttributes(s,e);let r=this.getDefault(e,t,i);return s.value=r,t[e.field]=r,s.addEventListener("input",()=>{t[e.field]=s.value}),s}createRangeInput(e,t,i){let s=document.createElement("input");return s.type="range",s.value=i??"0",s.className="smartgrid-input-range",s.style.width="100%",e.editor.min!==void 0&&(s.min=e.editor.min),e.editor.max!==void 0&&(s.max=e.editor.max),e.editor.step!==void 0&&(s.step=e.editor.step),s.setAttribute("data-editor-type","range"),this.CommonAttributes(s,e),s}}});var D,q=w(()=>{I();D=class{constructor(e){this.grid=e,this.toastElement=null,this.modalElement=null,this.contextMenuElement=null,this.columnPanelElement=null,this.loaderElement=null,this.paginationElement=null}createAll(){this.createToast(),this.createModal(),this.createContextMenu(),this.createLoader(),this.createColumnPanel(),this.grid.options.enablePagination&&this.createPagination()}createToast(){let e=document.createElement("div");e.id=`${this.grid.instanceId}_toast`,e.className="smartgrid-toast",e.setAttribute("data-instance",this.grid.instanceId),e.innerHTML=`
      <div class="smartgrid-toast-header" data-instance="${this.grid.instanceId}">
        <div class="smartgrid-toast-icon" id="${this.grid.instanceId}_toastIcon"></div>
        <div class="smartgrid-toast-title" id="${this.grid.instanceId}_toastTitle">\uC54C\uB9BC</div>
        <button class="smartgrid-toast-close" data-instance="${this.grid.instanceId}">&times;</button>
      </div>
      <div class="smartgrid-toast-body" id="${this.grid.instanceId}_toastBody"></div>
    `,document.body.appendChild(e),this.toastElement=e,this.toastTimer=null}showToast(e,t="info"){let i=this.toastElement;if(!i)return;let s=i.querySelector(`#${this.grid.instanceId}_toastIcon`),r=i.querySelector(`#${this.grid.instanceId}_toastTitle`),n=i.querySelector(`#${this.grid.instanceId}_toastBody`),a=i.querySelector(`.smartgrid-toast-close[data-instance="${this.grid.instanceId}"]`),d=["info","success","error","warning"];i.classList.remove(...d),i.classList.add(t),s.className=`smartgrid-toast-icon ${t}`,r.textContent=t.charAt(0).toUpperCase()+t.slice(1),n.textContent=e,this.toastTimer&&clearTimeout(this.toastTimer),i.classList.add("show");let o=()=>{i.classList.remove("show"),a.removeEventListener("click",o),this.toastTimer=null,setTimeout(()=>i.classList.remove(t),300)};a.addEventListener("click",o),this.toastTimer=setTimeout(o,3e3)}createModal(){let e=document.createElement("div");e.id=`${this.grid.instanceId}_modal`,e.className="smartgrid-modal",e.setAttribute("data-instance",this.grid.instanceId),e.innerHTML=`
      <div class="smartgrid-modal-backdrop" data-instance="${this.grid.instanceId}"></div>
      <div class="smartgrid-modal-content" data-instance="${this.grid.instanceId}">
        <div class="smartgrid-modal-header">
          <h5 class="smartgrid-modal-title">\uD655\uC778</h5>
          <button class="smartgrid-modal-close" data-instance="${this.grid.instanceId}">&times;</button>
        </div>
        <div class="smartgrid-modal-body">
          <p id="${this.grid.instanceId}_modalText"></p>
        </div>
        <div class="smartgrid-modal-footer">
          <button class="smartgrid-btn smartgrid-btn-secondary" data-dismiss="modal" data-instance="${this.grid.instanceId}">\uCDE8\uC18C</button>
          <button class="smartgrid-btn smartgrid-btn-primary" id="${this.grid.instanceId}_modalConfirm" data-instance="${this.grid.instanceId}">\uD655\uC778</button>
        </div>
      </div>
    `,document.body.appendChild(e),this.modalElement=e}showConfirmModal(e,t){let i=this.modalElement;if(!i)return;let s=i.querySelector(`#${this.grid.instanceId}_modalText`),r=i.querySelector(`#${this.grid.instanceId}_modalConfirm`),n=i.querySelectorAll(`[data-dismiss="modal"][data-instance="${this.grid.instanceId}"]`),a=i.querySelector(`.smartgrid-modal-close[data-instance="${this.grid.instanceId}"]`),d=i.querySelector(`.smartgrid-modal-backdrop[data-instance="${this.grid.instanceId}"]`);s.textContent=e,i.classList.add("show");let o=()=>{t(!0),i.classList.remove("show"),c()},l=()=>{t(!1),i.classList.remove("show"),c()},c=()=>{r.removeEventListener("click",o),n.forEach(g=>g.removeEventListener("click",l)),a?.removeEventListener("click",l),d?.removeEventListener("click",l)};r.addEventListener("click",o),n.forEach(g=>g.addEventListener("click",l)),a?.addEventListener("click",l),d?.addEventListener("click",l)}createContextMenu(){let e=document.createElement("div");e.id=`${this.grid.instanceId}_contextMenu`,e.className="smartgrid-context-menu",e.setAttribute("data-instance",this.grid.instanceId),e.innerHTML=`
      <div class="smartgrid-context-menu-item" data-action="copyCell" data-instance="${this.grid.instanceId}">\uC140 \uBCF5\uC0AC</div>
      <div class="smartgrid-context-menu-item" data-action="copyRow" data-instance="${this.grid.instanceId}">\uD589 \uBCF5\uC0AC</div>
      <div class="smartgrid-context-menu-divider"></div>
      <div class="smartgrid-context-menu-item" data-action="addRow" data-instance="${this.grid.instanceId}">\uD589 \uCD94\uAC00</div>
      <div class="smartgrid-context-menu-item" data-action="deleteRow" data-instance="${this.grid.instanceId}">\uD589 \uC0AD\uC81C</div>
      <div class="smartgrid-context-menu-divider"></div>
      <div class="smartgrid-context-menu-item" data-action="toggleColumns" data-instance="${this.grid.instanceId}">\uC5F4 \uD45C\uC2DC/\uC228\uAE40</div>
    `,document.body.appendChild(e),this.contextMenuElement=e}showContextMenu(e,t,i,s){let r=this.contextMenuElement;r&&(r.style.display="none",setTimeout(()=>{if(r.style.display="block",window.innerWidth<768)r.classList.add("smartgrid-context-menu-mobile"),r.style.left="",r.style.top="";else{r.classList.remove("smartgrid-context-menu-mobile");let a=r.getBoundingClientRect(),d=window.innerWidth,o=window.innerHeight,l=e,c=t;e+a.width>d-10&&(l=d-a.width-10),t+a.height>o-10&&(c=o-a.height-10),l<10&&(l=10),c<10&&(c=10),r.style.left=`${l}px`,r.style.top=`${c}px`}r.setAttribute("data-context-row-id",i),s&&r.setAttribute("data-context-cell-field",s)},10))}hideContextMenu(){this.contextMenuElement&&(this.contextMenuElement.style.display="none")}createColumnPanel(){let e=document.createElement("div");e.id=`${this.grid.instanceId}_columnPanel`,e.className="smartgrid-column-panel",e.setAttribute("data-instance",this.grid.instanceId),e.innerHTML=`
      <div class="smartgrid-column-panel-header">\uC5F4 \uD45C\uC2DC \uC124\uC815</div>
      <div class="smartgrid-column-panel-body" id="${this.grid.instanceId}_columnList"></div>
    `,document.body.appendChild(e),this.columnPanelElement=e}toggleColumnVisibilityPanel(){let e=this.columnPanelElement;if(!e)return;if(e.classList.toggle("active")){let i=this.grid.wrapper.querySelector('[data-action="toggleColumns"]');if(i){let s=i.getBoundingClientRect();e.style.left=`${s.left}px`,e.style.top=`${s.bottom+5}px`}this.renderColumnVisibilityPanel()}}renderColumnVisibilityPanel(){let e=this.columnPanelElement.querySelector(`#${this.grid.instanceId}_columnList`);e&&(e.innerHTML="",this.grid.columns.forEach(t=>{if(t.hideColumn)return;let i=document.createElement("div");i.className="column-visibility-item";let s=`${this.grid.instanceId}_col_vis_${t.field}`,r=document.createElement("input");r.type="checkbox",r.id=s,r.className="smartgrid-input-checkbox",r.checked=!this.grid.hiddenColumns.has(t.field),r.addEventListener("change",a=>{this.grid[a.target.checked?"showColumn":"hideColumn"](t.field)});let n=document.createElement("label");n.setAttribute("for",s),n.textContent=t.title,i.appendChild(r),i.appendChild(n),e.appendChild(i)}))}createLoader(){let e=document.createElement("div");e.id=`${this.grid.instanceId}_loader`,e.className="smartgrid-skeleton-loader",e.setAttribute("data-instance",this.grid.instanceId),e.innerHTML=`
      <div class="smartgrid-skeleton-spinner"></div>
      <div class="smartgrid-skeleton-text">\uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uB294 \uC911...</div>
    `,document.body.appendChild(e),this.loaderElement=e}showLoading(){this.loaderElement?.classList.add("active")}hideLoading(){this.loaderElement?.classList.remove("active")}createPagination(){let e=document.createElement("div");e.id=`${this.grid.instanceId}_pagination`,e.className="smartgrid-pagination",e.setAttribute("data-instance",this.grid.instanceId),this.grid.wrapper.appendChild(e),this.paginationElement=e}renderPagination(){if(!this.grid.options.enablePagination||!this.paginationElement||(this.paginationElement.innerHTML="",this.grid.totalRows===0))return;let e=Math.ceil(this.grid.totalRows/this.grid.pageSize),t=5,i=Math.ceil(this.grid.currentPage/t),s=(i-1)*t+1,r=Math.min(e,i*t),n=document.createElement("ul"),a=document.createDocumentFragment(),d=s-1;a.appendChild(this.createPaginationButton('<i class="bi bi-chevron-double-left"></i>',d,!1,d<1));for(let l=s;l<=r;l++)a.appendChild(this.createPaginationButton(l,l,l===this.grid.currentPage));let o=r+1;a.appendChild(this.createPaginationButton('<i class="bi bi-chevron-double-right"></i>',o,!1,o>e)),n.appendChild(a),this.paginationElement.appendChild(n)}createPaginationButton(e,t,i=!1,s=!1){let r=document.createElement("li");r.className="page-item",i&&r.classList.add("active"),s&&r.classList.add("disabled");let n=document.createElement("button");return n.classList.add("page-link"),n.innerHTML=e,s||n.addEventListener("click",()=>{this.grid.currentPage=t,this.grid.changePage()}),r.appendChild(n),r}destroyAll(){this.toastElement?.remove(),this.modalElement?.remove(),this.contextMenuElement?.remove(),this.loaderElement?.remove(),this.columnPanelElement?.remove(),this.paginationElement?.remove(),this.toastElement=null,this.modalElement=null,this.contextMenuElement=null,this.loaderElement=null,this.columnPanelElement=null,this.paginationElement=null}}});var $,j=w(()=>{I();$=class{constructor(e){this.grid=e}renderGrid(){try{this.clearTable(),this.grid.table.className="smartgrid-table",this.grid.table.setAttribute("data-instance",this.grid.instanceId),this.createTableHead(this.grid.table),this.createTableBody(this.grid.table),this.createTableFooter(this.grid.table)}catch(e){this.grid.handleError(e,"renderGrid")}}createColGroup(e){let t=document.createElement("colgroup");if(this.grid.enableCheckboxColumn){let i=document.createElement("col");i.className="sg-col-checkbox",i.style.width="var(--sg-col-checkbox-width)",t.appendChild(i)}if(this.grid.enableIndexColumn){let i=document.createElement("col");i.className="sg-col-index",i.style.width="var(--sg-col-index-width)",t.appendChild(i)}this.grid.columns.forEach(i=>{if(i.hideColumn||this.grid.hiddenColumns.has(i.field))return;let s=document.createElement("col");s.className="sg-col-data",s.setAttribute("data-field",i.field),i.width&&(s.style.width=i.width),t.appendChild(s)}),e.appendChild(t)}clearTable(){this.grid.table.replaceChildren()}createTableHead(e){let t=document.createElement("thead"),i=document.createElement("tr");this.addCheckboxHeader(i),this.addIndexHeader(i),this.addDataHeaders(i),t.appendChild(i),e.appendChild(t)}addCheckboxHeader(e){if(!this.grid.enableCheckboxColumn)return;let t=document.createElement("th");t.classList.add("sg-col-checkbox");let i=document.createElement("input");i.type="checkbox",i.classList.add("smartgrid-input-checkbox");let s=this.grid.currentPageData.length>0&&this.grid.currentPageData.every(r=>r.checked);i.checked=s,t.appendChild(i),e.appendChild(t)}addIndexHeader(e){if(!this.grid.enableIndexColumn)return;let t=document.createElement("th");t.classList.add("sg-col-index");let i=document.createElement("span");i.textContent="\uBC88\uD638",t.appendChild(i),e.appendChild(t)}addDataHeaders(e){this.grid.columns.forEach(t=>{if(t.hideColumn||this.grid.hiddenColumns.has(t.field))return;let i=document.createElement("th");i.style.width=t.width;let s=`sg-align-${t.headAlign||"center"}`;i.classList.add(s);let r=document.createElement("span");if(t.sortable){i.setAttribute("data-sortable","true"),i.setAttribute("data-field",t.field),i.style.cursor="pointer";let n=document.createElement("span");n.classList.add("col-title"),n.textContent=t.title,r.appendChild(n);let a=document.createElement("span");a.classList.add("sort-indicator"),a.innerHTML='<svg width="16" height="16" style="color: var(--sg-gray-400);"><use href="#icon-sort"></use></svg>',r.appendChild(a),this.grid.updateSortIndicator(t.field)}else r.textContent=t.title;if(i.appendChild(r),t.field){let n=document.createElement("div");n.classList.add("column-resizer"),n.setAttribute("data-field",t.field),n.addEventListener("mousedown",a=>this.grid.startColumnResize(a,t)),i.appendChild(n)}e.appendChild(i)})}createTableBody(e){let t=document.createElement("tbody");t.setAttribute("data-grid-body","true"),this.grid.currentPageData.length===0?this.addNoDataRow(t):this.addDataRows(t),e.appendChild(t)}addNoDataRow(e){let t=document.createElement("tr"),i=document.createElement("td"),s=this.grid.columns.filter(r=>!r.hideColumn&&!this.grid.hiddenColumns.has(r.field)).length;i.colSpan=s+(this.grid.enableCheckboxColumn?1:0)+(this.grid.enableIndexColumn?1:0),i.textContent="\uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.",i.classList.add("smartgrid-text-center"),i.style.padding="2rem",i.style.color="var(--sg-gray-400)",t.appendChild(i),e.appendChild(t)}addDataRows(e){let t=document.createDocumentFragment();this.grid.currentPageData.forEach((i,s)=>{t.appendChild(this.createDataRow(i,s))}),e.appendChild(t)}createDataRow(e,t){let i=document.createElement("tr");i.setAttribute("data-row-id",e[this.grid.idField]);let s=this.grid.changedRows.newRows.includes(e),r=this.grid.changedRows.updatedRows.includes(e);return s?i.classList.add("row-new"):r&&i.classList.add("row-updated"),e.checked&&i.classList.add("row-checked"),this.grid.isEditMode&&i.classList.add("edit-mode"),this.grid.enableCheckboxColumn&&i.appendChild(this.createCheckboxCell(e)),this.grid.enableIndexColumn&&i.appendChild(this.createIndexCell(e,t)),this.grid.columns.forEach(n=>{n.hideColumn||this.grid.hiddenColumns.has(n.field)||i.appendChild(this.createDataCell(n,e,s))}),i}createCheckboxCell(e){let t=document.createElement("td");t.classList.add("sg-col-checkbox");let i=document.createElement("input");return i.type="checkbox",i.checked=!!e.checked,i.classList.add("smartgrid-input-checkbox"),i.setAttribute("data-row-checkbox","true"),i.setAttribute("data-row-id",e[this.grid.idField]),t.appendChild(i),t}createIndexCell(e,t){let i=document.createElement("td");return i.classList.add("sg-col-index"),i.textContent=(this.grid.currentPage-1)*this.grid.pageSize+t+1,i}createDataCell(e,t,i){let s=document.createElement("td");s.setAttribute("data-field",e.field),s.setAttribute("data-row-id",t[this.grid.idField]),e.width&&(s.style.width=e.width,s.style.minWidth=e.width),(e.editor.readonly===!0||e.editor.editable===!1)&&s.classList.add("sg-cell-readonly");let n=t[e.field]??e.editor?.defaultVal??"",a=e.editor?.editable??!0;if((i||this.grid.isEditMode)&&a)s.appendChild(this.grid.createCellInput(e,t,n)),e.editor.type==="checkbox"||e.editor.type;else{let o=document.createElement("span");o.innerHTML=e.render?e.render(n,t,e):this.formatValue(e,n),s.style.textAlign=e.cellAlign,s.appendChild(o)}return s}formatValue(e,t){if(e.editor.type==="numberbox")return E(t,e.editor.decimalPlaces||0);if(e.editor.type==="selectbox"||e.editor.type==="radiobutton"){let s=(e.editor.options||[]).find(r=>String(r.val)===String(t));return s?s.text:t}return t}createTableFooter(e){if(!this.grid.columns.some(r=>r.sum))return;e?.querySelector("tfoot")?.remove();let i=document.createElement("tfoot"),s=document.createElement("tr");if(this.grid.enableCheckboxColumn){let r=document.createElement("td");r.classList.add("sg-col-checkbox"),r.appendChild(document.createElement("span")),s.appendChild(r)}if(this.grid.enableIndexColumn){let r=document.createElement("td");r.classList.add("sg-col-index");let n=document.createElement("span");n.textContent="\uD569\uACC4",r.appendChild(n),s.appendChild(r)}this.grid.columns.forEach(r=>{if(r.hideColumn||this.grid.hiddenColumns.has(r.field))return;let n=document.createElement("td"),a=document.createElement("span");if(r.width&&(n.style.width=r.width),r.sum&&r.editor.type==="numberbox"){let d=this.grid.currentPageData.reduce((o,l)=>o+(parseFloat(l[r.field])||0),0);a.textContent=E(d,r.editor.decimalPlaces||0),n.classList.add("sg-td-total")}n.appendChild(a),s.appendChild(n)}),i.appendChild(s),e.appendChild(i)}updateCellDisplay(e,t,i){let s=e.querySelector("input, select, textarea");if(s)if(s.type==="checkbox")s.checked=!!i;else if(s.type==="number"){let r=i;typeof i=="string"&&(r=i.replace(/,/g,"")),r=parseFloat(r),!isNaN(r)&&t?.editor?.decimalPlaces!==void 0&&(r=parseFloat(r.toFixed(t.editor.decimalPlaces))),s.value=isNaN(r)?"":r}else s.value=i??"";else{let r=e.querySelector("span");r&&(r.innerHTML=i??"")}}updateTableFooter(){this.grid.table&&this.createTableFooter(this.grid.table)}}});var L,U=w(()=>{L=class{constructor(e){this.grid=e,this.justResized=!1}setupEventDelegation(){let e=this.grid.table.querySelector("tbody[data-grid-body]"),t=this.grid.table.querySelector("thead");this.removeEventListeners(e,t),e&&(this.delegate(e,"change",this.handleBodyChange.bind(this)),this.delegate(e,"input",this.handleBodyChange.bind(this)),this.delegate(e,"contextmenu",this.handleBodyContextMenu.bind(this))),t&&this.delegate(t,"click",this.handleHeadClick.bind(this)),this.setupContextMenuEvents()}delegate(e,t,i){e[`${t}Handler`]=i,e.addEventListener(t,i)}removeEventListeners(e,t){e&&(e.changeHandler&&e.removeEventListener("change",e.changeHandler),e.inputHandler&&e.removeEventListener("input",e.inputHandler),e.contextmenuHandler&&e.removeEventListener("contextmenu",e.contextmenuHandler)),t&&t.clickHandler&&t.removeEventListener("click",t.clickHandler)}handleHeadClick(e){if(e.target.closest(".column-resizer"))return;let t=e.target.closest("thead th input[type='checkbox']");if(t)return this.handleMasterCheckboxClick(t);let i=e.target.closest("th[data-sortable='true']");if(i)return this.handleSortableHeaderClick(i)}handleMasterCheckboxClick(e){this.grid.currentPageData.forEach(t=>t.checked=e.checked),this.grid.renderGrid()}handleSortableHeaderClick(e){if(this.justResized)return;let t=e.getAttribute("data-field");t&&this.grid.sortColumn(t)}handleBodyChange(e){let t=e.target.closest("input[data-editor-type], select[data-editor-type], textarea[data-editor-type]");if(t)return this.handleInputChange(t);let i=e.target.closest('input[type="checkbox"][data-row-checkbox="true"]');if(i)return this.handleRowCheckboxChange(i)}handleInputChange(e){let t=e.closest("td[data-field]"),i=e.closest("tr[data-row-id]");if(!t||!i)return;let s=t.getAttribute("data-field"),r=i.getAttribute("data-row-id"),n=this.grid.findRowData(r);if(!n)return;let a;e.type==="checkbox"?a=e.checked:e.type==="radio"?a=i.querySelector(`input[name="${e.name}"]:checked`)?.value??"":a=e.value,this.grid.updateRowData(n,s,a)}handleRowCheckboxChange(e){let t=e.getAttribute("data-row-id"),i=this.grid.findRowData(t);if(i){i.checked=e.checked;let s=e.closest("tr[data-row-id]");s&&s.classList.toggle("row-checked",e.checked)}}handleBodyContextMenu(e){e.preventDefault(),e.stopPropagation();let t=e.target.closest("tr[data-row-id]");if(!t)return;let i=t.getAttribute("data-row-id"),r=e.target.closest("td[data-field]")?.getAttribute("data-field");this.grid.findRowData(i)&&this.grid.uiComponents.showContextMenu(e.pageX,e.pageY,i,r)}setupContextMenuEvents(){let e=this.grid.uiComponents.contextMenuElement;if(!e||e.hasClickHandler)return;let t=i=>{i.stopPropagation();let s=i.target.closest(`.smartgrid-context-menu-item[data-instance="${this.grid.instanceId}"]`);if(!s)return;let r=s.getAttribute("data-action"),n=e.getAttribute("data-context-row-id"),a=e.getAttribute("data-context-cell-field");e.style.display="none",this.handleContextMenuAction(r,n,a),e.removeAttribute("data-context-row-id"),e.removeAttribute("data-context-cell-field")};e.addEventListener("click",t),e.hasClickHandler=!0}handleContextMenuAction(e,t,i){switch(e){case"copyCell":t&&i&&this.copyCellValue(t,i);break;case"copyRow":t&&this.copyRowData(t);break;case"addRow":this.grid.addRow();break;case"deleteRow":if(t){let s=this.grid.findRowData(t);s&&(s.checked=!0,this.grid.deleteRow())}break;case"toggleColumns":this.grid.uiComponents.toggleColumnVisibilityPanel();break}}async copyCellValue(e,t){let i=this.grid.findRowData(e);if(i)try{await navigator.clipboard.writeText(String(i[t]??"")),this.grid.showToast("\uC140 \uAC12\uC774 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","success")}catch{this.grid.showToast("\uBCF5\uC0AC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","error")}}async copyRowData(e){let t=this.grid.findRowData(e);if(!t)return;let s=this.grid.columns.filter(r=>!r.hideColumn&&!this.grid.hiddenColumns.has(r.field)).map(r=>t[r.field]??"").join("	");try{await navigator.clipboard.writeText(s),this.grid.showToast("\uD589 \uB370\uC774\uD130\uAC00 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","success")}catch{this.grid.showToast("\uBCF5\uC0AC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","error")}}startColumnResize(e,t){this.grid.isResizing=!0,this.grid.resizeStartX=e.clientX,this.grid.resizeField=t.field;let i=e.target.closest("th");this.grid.resizeStartWidth=i.offsetWidth,this.grid.table.classList.add("resizing-active"),document.body.style.cursor="col-resize",e.preventDefault()}handleColumnResizeMove(e){if(!this.grid.isResizing)return;let t=this.grid.table.querySelector(`.column-resizer[data-field="${this.grid.resizeField}"]`);if(!t)return;let i=t.closest("th");if(!i)return;let s=e.clientX-this.grid.resizeStartX,r=this.grid.resizeStartWidth+s;r<50&&(r=50),i.style.width=`${r}px`,i.style.minWidth=`${r}px`}handleColumnResizeEnd(){if(!this.grid.isResizing)return;this.grid.isResizing=!1,this.grid.table.classList.remove("resizing-active"),document.body.style.cursor="";let e=this.grid.columns.find(t=>t.field===this.grid.resizeField);if(e){let i=this.grid.table.querySelector(`.column-resizer[data-field="${this.grid.resizeField}"]`)?.closest("th");i&&(e.width=`${i.offsetWidth}px`)}this.justResized=!0,setTimeout(()=>{this.justResized=!1},200),this.grid.resizeField=null}}});var N,it=w(()=>{N=class{constructor(e){if(!e)throw new Error("PluginManager requires a SmartGrid instance");this.grid=e,this.plugins=new Map,this.initializationOrder=[]}register(e,t={}){try{let i=new e(this.grid,t);if(!i.name||typeof i.name!="string")throw new Error("\uD50C\uB7EC\uADF8\uC778\uC740 name \uC18D\uC131(string)\uC774 \uD544\uC694\uD569\uB2C8\uB2E4");let s=i.name;return this.plugins.has(s)&&(this.grid.warn("PLUGIN_ALREADY_REGISTERED",`\uD50C\uB7EC\uADF8\uC778 "${s}"\uC774 \uC774\uBBF8 \uB4F1\uB85D\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4. \uB36E\uC5B4\uC501\uB2C8\uB2E4.`),this.unregister(s)),this.plugins.set(s,i),this.initializationOrder.push(s),this._definePluginAccessor(s),typeof i.install=="function"&&i.install(),this.grid.info(`\uD50C\uB7EC\uADF8\uC778 "${s}" v${i.version||"1.0.0"} \uB4F1\uB85D \uC644\uB8CC`),this.grid.emit("pluginRegistered",{name:s,version:i.version||"1.0.0",instance:i}),this.grid}catch(i){throw this.grid.handleError(i,"PluginManager.register"),i}}unregister(e){try{let t=this.plugins.get(e);if(!t)return this.grid.warn("PLUGIN_NOT_FOUND",`\uD50C\uB7EC\uADF8\uC778 "${e}"\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.`),!1;typeof t.uninstall=="function"&&t.uninstall(),this._removePluginAccessor(e),this.plugins.delete(e);let i=this.initializationOrder.indexOf(e);return i!==-1&&this.initializationOrder.splice(i,1),this.grid.info(`\uD50C\uB7EC\uADF8\uC778 "${e}" \uC81C\uAC70 \uC644\uB8CC`),this.grid.emit("pluginUnregistered",{name:e}),!0}catch(t){return this.grid.handleError(t,"PluginManager.unregister"),!1}}has(e){return this.plugins.has(e)}get(e){return this.plugins.get(e)||null}getNames(){return Array.from(this.plugins.keys())}getAll(){return Array.from(this.plugins.values())}getAllAsMap(){return new Map(this.plugins)}unregisterAll(){[...this.initializationOrder].reverse().forEach(t=>this.unregister(t)),this.plugins.size>0&&this.plugins.forEach((t,i)=>{this.unregister(i)})}get count(){return this.plugins.size}isInstalled(e){let t=this.get(e);return t?typeof t.isInstalled=="function"?t.isInstalled():t.initialized===!0:!1}filter(e){if(typeof e!="function")throw new Error("filter requires a function");return this.getAll().filter(e)}getPluginInfoList(){return this.getAll().map(e=>({name:e.name,version:e.version||"1.0.0",installed:this.isInstalled(e.name),options:e.options||{}}))}getInitializationOrder(){return[...this.initializationOrder]}validateDependencies(e){let t=this.get(e);if(!t)return!1;let i=t.dependencies||[];if(i.length===0)return!0;let s=i.filter(r=>!this.has(r));return s.length>0?(this.grid.warn("PLUGIN_DEPENDENCY_MISSING",`\uD50C\uB7EC\uADF8\uC778 "${e}"\uC758 \uC758\uC874\uC131\uC774 \uB204\uB77D\uB418\uC5C8\uC2B5\uB2C8\uB2E4: ${s.join(", ")}`),!1):!0}validateAllDependencies(){let e=!0;return this.getNames().forEach(t=>{this.validateDependencies(t)||(e=!1)}),e}_definePluginAccessor(e){if(this.grid[e]!==void 0){this.grid.warn("PLUGIN_NAME_CONFLICT",`\uD50C\uB7EC\uADF8\uC778 \uC774\uB984 "${e}"\uC774 \uC774\uBBF8 SmartGrid\uC758 \uC18D\uC131/\uBA54\uC11C\uB4DC\uC640 \uCDA9\uB3CC\uD569\uB2C8\uB2E4.`);return}Object.defineProperty(this.grid,e,{get(){return this.pluginManager.plugins.get(e)},configurable:!0,enumerable:!1})}_removePluginAccessor(e){if(this.grid[e]!==void 0)try{delete this.grid[e]}catch{this.grid.warn("PLUGIN_ACCESSOR_REMOVAL_FAILED",`\uD50C\uB7EC\uADF8\uC778 "${e}"\uC758 \uC811\uADFC\uC790 \uC81C\uAC70\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.`)}}debug(e=!1){this.grid.debugMode&&(console.group(`\u{1F50C} Plugin Manager [${this.grid.tableId}]`),console.log(`Total Plugins: ${this.count}`),console.log(`Initialization Order: ${this.initializationOrder.join(" \u2192 ")}`),e?this.plugins.forEach((t,i)=>{console.group(`  \u{1F4E6} ${i}`),console.log(`    Version: ${t.version||"1.0.0"}`),console.log(`    Installed: ${this.isInstalled(i)?"\u2713":"\u2717"}`),console.log(`    Dependencies: ${t.dependencies?.join(", ")||"None"}`),console.log("    Options:",t.options),console.groupEnd()}):this.plugins.forEach((t,i)=>{let s=this.isInstalled(i)?"\u2713":"\u2717";console.log(`  ${s} ${i} (v${t.version||"1.0.0"})`)}),console.groupEnd())}exportConfigs(){return this.getAll().map(e=>({name:e.name,version:e.version||"1.0.0",options:{...e.options}}))}async batchRegister(e){if(!Array.isArray(e))throw new Error("batchRegister requires an array of plugin configs");for(let t of e){if(!t.Plugin){this.grid.warn("INVALID_PLUGIN_CONFIG","Plugin \uC18D\uC131\uC774 \uB204\uB77D\uB41C \uC124\uC815\uC774 \uC788\uC2B5\uB2C8\uB2E4.");continue}try{await this.register(t.Plugin,t.options||{})}catch(i){this.grid.handleError(i,"PluginManager.batchRegister")}}return this.grid}enable(e){let t=this.get(e);return t?this.isInstalled(e)?(this.grid.info(`\uD50C\uB7EC\uADF8\uC778 "${e}"\uC740 \uC774\uBBF8 \uD65C\uC131\uD654\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.`),!0):typeof t.install=="function"?(t.install(),this.grid.info(`\uD50C\uB7EC\uADF8\uC778 "${e}" \uD65C\uC131\uD654\uB428`),this.grid.emit("pluginEnabled",{name:e}),!0):!1:(this.grid.warn("PLUGIN_NOT_FOUND",`\uD50C\uB7EC\uADF8\uC778 "${e}"\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.`),!1)}disable(e){let t=this.get(e);return t?this.isInstalled(e)?typeof t.uninstall=="function"?(t.uninstall(),this.grid.info(`\uD50C\uB7EC\uADF8\uC778 "${e}" \uBE44\uD65C\uC131\uD654\uB428`),this.grid.emit("pluginDisabled",{name:e}),!0):!1:(this.grid.info(`\uD50C\uB7EC\uADF8\uC778 "${e}"\uC740 \uC774\uBBF8 \uBE44\uD65C\uC131\uD654\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.`),!0):(this.grid.warn("PLUGIN_NOT_FOUND",`\uD50C\uB7EC\uADF8\uC778 "${e}"\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.`),!1)}restart(e){return this.get(e)?(this.disable(e),this.enable(e)):(this.grid.warn("PLUGIN_NOT_FOUND",`\uD50C\uB7EC\uADF8\uC778 "${e}"\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.`),!1)}getStatus(){let e=[],t=[];return this.plugins.forEach((i,s)=>{this.isInstalled(s)?e.push(s):t.push(s)}),{installed:e,uninstalled:t}}getStats(){let e=this.getStatus();return{total:this.count,installed:e.installed.length,uninstalled:e.uninstalled.length,names:this.getNames(),initOrder:this.getInitializationOrder()}}}});var st={};O(st,{SmartGrid:()=>M});var m,M,H=w(()=>{B();z();V();G();q();j();U();it();I();m=class m extends v{constructor(t,i={}){super();u(this,"table");u(this,"options");u(this,"wrapper",null);u(this,"dataHandler",null);u(this,"renderer",null);u(this,"eventHandler",null);u(this,"uiComponents",null);u(this,"pluginManager",null);u(this,"columns",[]);u(this,"originalData",[]);u(this,"originalDataBackup",[]);u(this,"currentPageData",[]);u(this,"totalRows",0);u(this,"pageSize",10);u(this,"currentPage",1);u(this,"pagingMode","client");u(this,"isEditMode",!1);u(this,"changedRows",{newRows:[],updatedRows:[],deletedRows:[]});u(this,"sortOrders",[]);u(this,"rowHeight",35);u(this,"isResizing",!1);u(this,"resizeStartX",0);u(this,"resizeStartWidth",0);u(this,"resizeField",null);u(this,"hiddenColumns",new Set);u(this,"inputFactory",null);u(this,"filters",{});u(this,"warnings",[]);u(this,"lastParams",{});try{if(this.tableId=t,this.instanceId=`sg_${t}`,this.debugMode=i.debug??!1,this.table=document.getElementById(t),!this.table)throw new y(`\uD14C\uC774\uBE14\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4: "${t}"`,"ELEMENT_NOT_FOUND",this.instanceId,{tableId:t});m.instances.add(this),this.columns=i.columns||[],this.options={idField:"id",pageSize:10,page:1,pagingMode:"client",rowHeight:35,enableCheckboxColumn:!0,enableIndexColumn:!0,enableEditMode:!0,loadFilter:null,onLoadSuccess:null,onLoadError:null,enableToolbar:!0,enablePagination:!0,enableTotalRows:!0,enablePageSizeSelect:!0,toolbarButtons:Object.keys(m.BUTTON_CONFIG),queryParams:{},...i},this.lastParams=this.options.queryParams||{},this.pageSize=this.options.pageSize,this.currentPage=this.options.page,this.rowHeight=this.options.rowHeight,this.pluginManager=new N(this),this.options.pagingMode==="server"&&this.options.url?this.dataHandler=new S(this):this.dataHandler=new C(this),this.renderer=new $(this),this.eventHandler=new L(this),this.uiComponents=new D(this),this.initializeColumns(),this.setRowHeight(this.rowHeight,!1),this.createWrapper(),this.createUIElements(),this.initializeGlobalEvents(),this.validateConfiguration(),this.info("\uADF8\uB9AC\uB4DC \uCD08\uAE30\uD654 \uC644\uB8CC")}catch(s){throw this.handleError(s,"constructor"),s}}get idField(){return this.options.idField}get enableCheckboxColumn(){return this.options.enableCheckboxColumn}get enableIndexColumn(){return this.options.enableIndexColumn}get editModeEnabled(){return this.options.enableEditMode}static getInstance(t){for(let i of m.instances)if(i.instanceId===t)return i;return null}static findByTableId(t){for(let i of m.instances)if(i.tableId===t)return i;return null}static getAllInstances(){return Array.from(m.instances)}use(t,i={}){return this.pluginManager.register(t,i)}removePlugin(t){return this.pluginManager.unregister(t)}hasPlugin(t){return this.pluginManager.has(t)}getPluginNames(){return this.pluginManager.getNames()}getPlugin(t){return this.pluginManager.get(t)}initializeColumns(){this.columns.forEach((t,i)=>{t.field??(t.field=t.hideColumn?void 0:`column_${i}`),t.title??(t.title=t.field||`\uCEEC\uB7FC ${i+1}`),t.width??(t.width="auto"),t.headAlign??(t.headAlign="center"),t.print??(t.print=!0),t.exportExcel??(t.exportExcel=!0),(typeof t.editor!="object"||t.editor===null)&&(t.editor={type:t.editor||"textbox"}),t.cellAlign??(t.cellAlign=t.editor.type==="numberbox"?"right":"left")})}createWrapper(){let t=document.createElement("div");t.className="smartgrid-container",this.table.parentNode.insertBefore(t,this.table),t.appendChild(this.table);let i=document.createElement("div");i.className="smartgrid-wrapper",i.setAttribute("data-instance",this.instanceId),i.setAttribute("data-grid-id",this.tableId),this.options.width!==void 0&&(i.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width),t.parentNode.insertBefore(i,t),i.appendChild(t),this.options.height!==void 0&&(t.style.height=typeof this.options.height=="number"?`${this.options.height}px`:this.options.height),t.style.overflow="auto",t.setAttribute("data-instance",this.instanceId),t.setAttribute("data-grid-id",this.tableId),this.wrapper=i}createUIElements(){this.uiComponents.createAll(),(this.options.enableToolbar||this.options.enableTotalRows||this.options.enablePageSizeSelect)&&this.createToolbar()}createToolbar(){if(!this.options.enableToolbar&&!this.options.enableTotalRows&&!this.options.enablePageSizeSelect)return;let t=document.createElement("div");t.className="smartgrid-toolbar-container",t.setAttribute("data-grid-id",this.tableId);let i=document.createElement("div");if(i.className="smartgrid-toolbar-section",this.options.enableToolbar){let r=document.createElement("div");r.className="smartgrid-toolbar-group",i.appendChild(r);let n=this.options.toolbarButtons;(Array.isArray(n)?n.map(d=>[null,d]):Object.entries(n)).forEach(([d,o])=>{let l;typeof o=="string"?l=m.BUTTON_CONFIG[o]:l=o[Object.keys(o)[0]];let c=document.createElement("button");c.className=l.className?l.className:"smartgrid-btn smartgrid-btn-secondary";let g=l.icon?`<i class="${l.icon}"></i>`:"";c.innerHTML=`${g}<span>${l.text}</span>`,c.addEventListener("click",f=>{if(f.stopPropagation(),typeof l.action=="function")l.action.call(this,f);else if(typeof l.action=="string"){let p=this[l.action];typeof p=="function"&&p.apply(this,l.params||[])}}),r.appendChild(c)})}let s=document.createElement("div");if(s.className="smartgrid-toolbar-section",this.options.enableTotalRows){let r=document.createElement("div");r.id=`${this.instanceId}_totalRows`,r.className="smartgrid-info-text",s.appendChild(r),this.totalRowsElement=r}if(this.options.enablePageSizeSelect){let r=document.createElement("select");r.id=`${this.instanceId}_pageSize`,r.className="smartgrid-select",r.innerHTML=m.PAGE_SIZE_OPTIONS.map(n=>`<option value="${n.value}">${n.text}</option>`).join(""),r.value=this.pageSize,r.addEventListener("change",n=>{let a=n.target.value;a==="all"?this.pagingMode==="client"?(this.setPageSize(this.getSortedData().length||1),this.changePage()):this.totalRows>0?(this.setPageSize(this.totalRows),this.changePage()):(this.showToast("\uC11C\uBC84\uC0AC\uC774\uB4DC \uBAA8\uB4DC\uC5D0\uC11C\uB294 '\uC804\uCCB4 \uBCF4\uAE30'\uB97C \uC9C0\uC6D0\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.","warning"),n.target.value=this.pageSize):(this.setPageSize(parseInt(a,10)),this.changePage())}),s.appendChild(r),this.pageSizeSelectElement=r}i.children.length>0&&t.appendChild(i),s.children.length>0&&t.appendChild(s),t.children.length>0&&(this.wrapper.insertBefore(t,this.wrapper.firstChild),this.toolbarElement=t)}initializeGlobalEvents(){m.globalEventsInitialized||(document.addEventListener("mousemove",t=>{m.instances.forEach(i=>{i.isResizing&&i.eventHandler.handleColumnResizeMove(t)})}),document.addEventListener("mouseup",t=>{m.instances.forEach(i=>{i.isResizing&&i.eventHandler.handleColumnResizeEnd(t)})}),document.addEventListener("click",t=>{m.instances.forEach(i=>{let s=i.uiComponents.contextMenuElement;s&&!s.contains(t.target)&&(!t.target.closest(".smartgrid-context-menu-item")||t.target.getAttribute("data-instance")!==i.instanceId)&&(s.style.display="none");let r=i.uiComponents.columnPanelElement;if(r&&!r.contains(t.target)){let n=document.getElementById(`${i.instanceId}_toggleColumnsBtn`);(!n||!n.contains(t.target))&&r.classList.remove("active")}})}),m.globalEventsInitialized=!0)}validateConfiguration(){(!this.columns||this.columns.length===0)&&this.warn("NO_COLUMNS","\uCEEC\uB7FC\uC774 \uC815\uC758\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4. \uBE48 \uD14C\uC774\uBE14\uC774 \uD45C\uC2DC\uB429\uB2C8\uB2E4.");let t=this.columns.map(s=>s.field).filter(Boolean),i=t.filter((s,r)=>t.indexOf(s)!==r);i.length>0&&this.warn("DUPLICATE_FIELDS",`\uC911\uBCF5\uB41C \uD544\uB4DC ID\uAC00 \uBC1C\uACAC\uB418\uC5C8\uC2B5\uB2C8\uB2E4: ${i.join(", ")}`),this.options.pageSize>100&&this.warn("LARGE_PAGE_SIZE",`\uD398\uC774\uC9C0 \uD06C\uAE30\uAC00 \uB108\uBB34 \uD07D\uB2C8\uB2E4: ${this.options.pageSize}. \uC131\uB2A5 \uC800\uD558\uAC00 \uBC1C\uC0DD\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.`)}async loadData(t){if(this.dataHandler instanceof C)return this.dataHandler.load(t);this.warn("INVALID_OPERATION","\uC11C\uBC84 \uBAA8\uB4DC\uC5D0\uC11C\uB294 loadData \uB300\uC2E0 fetchData\uB97C \uC0AC\uC6A9\uD574\uC57C \uD569\uB2C8\uB2E4.")}async fetchData(t){return t!==void 0&&(this.lastParams=t),this.dataHandler.load()}async sortColumn(t){this.emit("beforeSort",{field:t,sortOrders:[...this.sortOrders]});let i=this.sortOrders.findIndex(s=>s.field===t);if(i!==-1){let s=this.sortOrders[i].order;s==="asc"?this.sortOrders[i].order="desc":s==="desc"&&this.sortOrders.splice(i,1)}else this.sortOrders.push({field:t,order:"asc"});await this.dataHandler.sort(),this.emit("afterSort",{field:t,sortOrders:[...this.sortOrders]})}async changePage(){let t={currentPage:this.currentPage,cancelled:!1};this.emit("beforePageChange",t),!t.cancelled&&(await this.dataHandler.page(),this.emit("afterPageChange",{currentPage:this.currentPage}))}setPageSize(t){this.pageSize=parseInt(t,10),this.currentPage=1}addRow(){this.dataHandler.add()}saveRow(){this.dataHandler.save()}rejectRow(){this.dataHandler.reject()}deleteRow(){this.dataHandler.delete()}getData(){return this.getSortedData()}getSortedData(){return this.dataHandler.getSortedData()}getRows(){return[...this.currentPageData]}getCheckedRows(){return!this.currentPageData||!Array.isArray(this.currentPageData)?(this.warn("GET_CHECKED_ROWS_FAILED","\uD604\uC7AC \uD398\uC774\uC9C0 \uB370\uC774\uD130\uAC00 \uC720\uD6A8\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4."),[]):this.currentPageData.filter(t=>t.checked===!0)}updateTotalRowsInfo(){this.dataHandler.updateTotalRowsInfo()}invalidateSortCache(){this.dataHandler instanceof C&&this.dataHandler.invalidateSortCache()}renderGrid(){this.renderer.renderGrid(),this.eventHandler.setupEventDelegation()}renderPagination(){this.uiComponents.renderPagination()}updateSortIndicator(t){let i=this.table.querySelector(`th[data-field="${t}"]`);if(!i)return;let s=i.querySelector(".sort-indicator");if(!s)return;let{order:r,index:n}=this.getSortOrder(t),a="";n!==null&&(a+=`<span class="smartgrid-badge">${n}</span>`),r==="asc"?a+='<i class="bi bi-caret-up-fill" style="font-size:12px; color: var(--sg-gray-900);"></i>':r==="desc"?a+='<i class="bi bi-caret-down-fill" style="font-size:12px; color: var(--sg-gray-900);"></i>':a+='<i class="bi bi-arrow-down-up" style="font-size:12px; color: var(--sg-gray-400);"></i>',s.innerHTML=a}startColumnResize(t,i){this.eventHandler.startColumnResize(t,i)}getInputFactory(){return this.inputFactory??(this.inputFactory=new T(this)),this.inputFactory}createCellInput(t,i,s){return this.getInputFactory().create(t,i,s)}updateRowData(t,i,s){if(t[i]===s)return;let r=t[i],n=this.columns.find(l=>l.field===i),a={rowData:t,field:i,oldValue:r,newValue:s,cancelled:!1};if(this.emit("beforeCellChange",a),a.cancelled)return;n?.editor.type==="numberbox"&&(s===""||s===null||s===void 0?s=null:(typeof s=="string"&&(s=s.replace(/,/g,"")),s=parseFloat(s)||0,n.editor.decimalPlaces!==void 0&&(s=parseFloat(s.toFixed(n.editor.decimalPlaces))))),t[i]=s;let d=this.table.querySelector(`tr[data-row-id="${t[this.idField]}"]`),o=this.columns.filter(l=>typeof l.formula=="function");if(o.length>0&&d){let l=new Map(Array.from(d.querySelectorAll("td[data-field]")).map(c=>[c.getAttribute("data-field"),c]));o.forEach((c,g)=>{let f=this.evaluateFormula(c.formula,t,c,g);isNaN(f)&&(f=0),c.editor.type==="numberbox"&&c.editor.decimalPlaces!==void 0&&(f=parseFloat(f.toFixed(c.editor.decimalPlaces))),t[c.field]=f;let p=l.get(c.field);if(p){let Z=f;if(c.editor.type==="numberbox"&&c.editor.decimalPlaces!==void 0){let at=c.editor.decimalPlaces;Z=E(f,at)}this.renderer.updateCellDisplay(p,c,Z)}})}!this.changedRows.newRows.includes(t)&&!this.changedRows.updatedRows.includes(t)&&(this.changedRows.updatedRows.push(t),d?.classList.add("row-updated")),this.invalidateSortCache(),this.renderer.updateTableFooter(),this.emit("afterCellChange",{rowData:t,field:i,oldValue:r,newValue:s})}findRowData(t){let i=s=>String(s[this.idField])===String(t);return this.currentPageData.find(i)||this.originalData.find(i)}applyFormula(t){this.columns.forEach((i,s)=>{i.formula&&(t[i.field]=this.evaluateFormula(i.formula,t,i,s))})}evaluateFormula(t,i,s,r){if(typeof t=="function")try{let n=t(i,s,r);return isNaN(n)?0:n}catch(n){return console.error(`Error executing formula for column "${s.field}":`,n),0}}compareRowsForSort(t,i){for(let{field:s,order:r}of this.sortOrders){let n=t[s]??"",a=i[s]??"";if(n<a)return r==="asc"?-1:1;if(n>a)return r==="asc"?1:-1}return 0}applyFilters(t){return!this.filters||Object.keys(this.filters).length===0?t:t.filter(i=>{if(this.filters.keyword){let s=this.filters.keyword.toLowerCase();if(!["fCode","fName","fOrigin","comment"].some(a=>String(i[a]||"").toLowerCase().includes(s)))return!1}return!(this.filters.startDate&&i.expDate<this.filters.startDate||this.filters.endDate&&i.expDate>this.filters.endDate||this.filters.status&&this.filters.status.length>0&&!this.filters.status.includes(i.stockStatus))})}getSortOrder(t){let i=this.sortOrders.find(r=>r.field===t),s=this.sortOrders.findIndex(r=>r.field===t);return{order:i?.order||null,index:s!==-1?s+1:null}}setRowHeight(t,i=!0){this.rowHeight=parseInt(t,10)||30,this.table?this.table.style.setProperty("--row-height",`${this.rowHeight}px`):document.documentElement.style.setProperty("--row-height",`${this.rowHeight}px`),i&&(this.renderGrid(),this.showToast(`\uD589 \uB192\uC774\uAC00 ${this.rowHeight}px\uB85C \uC124\uC815\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,"info"))}setEditMode(t){if(t&&(this.changedRows.newRows.length>0||this.changedRows.updatedRows.length>0||this.changedRows.deletedRows.length>0))return this.showToast("\uC800\uC7A5\uD558\uC9C0 \uC54A\uC740 \uBCC0\uACBD \uC0AC\uD56D\uC774 \uC788\uC2B5\uB2C8\uB2E4. \uBA3C\uC800 \uC800\uC7A5\uD558\uAC70\uB098 \uCDE8\uC18C\uD574\uC8FC\uC138\uC694.","warning"),!1;if(!this.editModeEnabled)return this.showToast("\uC774 \uADF8\uB9AC\uB4DC\uB294 \uC218\uC815 \uBAA8\uB4DC\uAC00 \uBE44\uD65C\uC131\uD654\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.","warning"),!1;if(this.isEditMode===t)return!1;let i={previousMode:this.isEditMode,newMode:t,cancelled:!1};if(this.emit("beforeEditModeChange",i),i.cancelled)return!1;t&&!this.isEditMode&&(!this.originalDataBackup||this.originalDataBackup.length===0)&&(this.originalDataBackup=b(this.originalData)),this.isEditMode=t,this.renderGrid();let s=t?"\uC218\uC815 \uBAA8\uB4DC \uD65C\uC131\uD654":"\uC218\uC815 \uBAA8\uB4DC \uBE44\uD65C\uC131\uD654";return this.showToast(s,"success"),this.emit("afterEditModeChange",{previousMode:i.previousMode,currentMode:t}),!0}isEditModeEnabled(){return this.editModeEnabled}getEditMode(){return this.isEditMode}validateChanges(){let t=[...this.changedRows.newRows,...this.changedRows.updatedRows],i={rowsToValidate:t,cancelled:!1};if(this.emit("beforeValidate",i),i.cancelled)return!1;let s=[];for(let r of t)for(let n of this.columns){let a=r[n.field];if(n.editor?.required&&(a==null||String(a).trim()==="")){this.showToast(`'${n.title}' \uD544\uB4DC\uB294 \uD544\uC218 \uC785\uB825 \uD56D\uBAA9\uC785\uB2C8\uB2E4.`,"error");let o=this.table.querySelector(`tr[data-row-id="${r[this.idField]}"]`)?.querySelector(`td[data-field="${n.field}"]`);o&&(o.classList.add("cell-invalid"),o.querySelector("input, select, textarea")?.focus(),setTimeout(()=>o.classList.remove("cell-invalid"),3e3));let l={rowData:r,column:n,value:a,message:`'${n.title}' \uD544\uB4DC\uB294 \uD544\uC218 \uC785\uB825 \uD56D\uBAA9\uC785\uB2C8\uB2E4.`};return s.push(l),this.emit("validationError",l),this.emit("afterValidate",{isValid:!1,errors:s}),!1}if(typeof n.editor?.validate=="function")try{let d=n.editor.validate(a,r,n);if(d!==!0){let o=typeof d=="string"?d:`'${n.title}' \uD544\uB4DC\uC758 \uAC12\uC774 \uC720\uD6A8\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.`;this.showToast(o,"error");let c=this.table.querySelector(`tr[data-row-id="${r[this.idField]}"]`)?.querySelector(`td[data-field="${n.field}"]`);c&&(c.classList.add("cell-invalid"),c.querySelector("input, select, textarea")?.focus(),setTimeout(()=>c.classList.remove("cell-invalid"),3e3));let g={rowData:r,column:n,value:a,message:o};return s.push(g),this.emit("validationError",g),this.emit("afterValidate",{isValid:!1,errors:s}),!1}}catch(d){let o=`'${n.title}' \uC720\uD6A8\uC131 \uAC80\uC0AC \uC911 \uC624\uB958: ${d.message}`;console.error(`Validation function error for ${n.field}:`,d),this.showToast(o,"error");let c=this.table.querySelector(`tr[data-row-id="${r[this.idField]}"]`)?.querySelector(`td[data-field="${n.field}"]`);c&&(c.classList.add("cell-invalid"),c.querySelector("input, select, textarea")?.focus(),setTimeout(()=>c.classList.remove("cell-invalid"),3e3));let g={rowData:r,column:n,value:a,message:o};return s.push(g),this.emit("validationError",g),this.emit("afterValidate",{isValid:!1,errors:s}),!1}}return this.emit("afterValidate",{isValid:!0,errors:[]}),!0}printCurrentPage(){let t=this.getSortedData();if(!t.length){this.showToast("\uC778\uC1C4\uD560 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.","warning");return}this.showLoading();try{let i=this.columns.filter(n=>!n.hideColumn&&!this.hiddenColumns.has(n.field)&&n.print!==!1),r=`<table border="1" style="width: 100%; border-collapse: collapse; text-align: center; font-size: 10pt;"><thead><tr style="background: #f0f0f0;"><th style="width: 50px;">\uBC88\uD638</th>${i.map(n=>`<th style="${n.width?`width:${n.width};`:""} text-align: ${n.headAlign||"center"}; padding: 6px;">${n.title}</th>`).join("")}</tr></thead><tbody>${t.map((n,a)=>`<tr><td style="padding: 6px;">${a+1}</td>${i.map(d=>`<td style="text-align: ${d.cellAlign||(d.editor.type==="numberbox"?"right":"left")}; padding: 6px;">${E(n[d.field]??"",d.editor.decimalPlaces||0)}</td>`).join("")}</tr>`).join("")}</tbody></table>`;this.openPrintWindow(r)}finally{this.hideLoading()}}openPrintWindow(t){let i=window.open("","_blank","width=800,height=600"),s=document.title,r=F();i.document.write(`<html><head><title>\uC778\uC1C4</title><style>@media print{@page{margin:1cm}thead{display:table-header-group}}body{font-family:'Malgun Gothic','Arial',sans-serif}h1{text-align:center;margin-bottom:5px;font-size:18pt}.subtitle{text-align:center;color:#666;margin-bottom:20px;font-size:10pt}table{width:100%;border-collapse:collapse;table-layout:fixed}th,td{border:1px solid #ccc;padding:8px;font-size:9pt;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}th{background:#f5f5f5;font-weight:bold}</style></head><body><h1>${s.replace("V4","\uC778\uC1C4")}</h1><div class="subtitle">\uCD9C\uB825\uC77C: ${r}</div>${t}</body></html>`),i.document.close(),i.focus(),setTimeout(()=>i.print(),250)}hideColumn(t){this.hiddenColumns.add(t),this.renderGrid(),this.showToast(`"${this.columns.find(i=>i.field===t)?.title}" \uC5F4\uC774 \uC228\uACA8\uC84C\uC2B5\uB2C8\uB2E4.`,"info")}showColumn(t){this.hiddenColumns.delete(t),this.renderGrid(),this.showToast(`"${this.columns.find(i=>i.field===t)?.title}" \uC5F4\uC774 \uD45C\uC2DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,"info")}showLoading(){this.uiComponents.showLoading()}hideLoading(){this.uiComponents.hideLoading()}showToast(t,i="info"){this.uiComponents.showToast(t,i)}showConfirmModal(t,i){this.uiComponents.showConfirmModal(t,i)}handleError(t,i=""){let s={message:t.message,code:t.code||"UNKNOWN_ERROR",context:i,instanceId:this.instanceId,tableId:this.tableId,timestamp:new Date().toISOString(),stack:t.stack};this.debugMode&&(console.group(`\u274C SmartGrid Error [${this.tableId}]`),console.error("Error:",t.message),console.log("Context:",i),console.log("Instance:",this.instanceId),console.groupEnd()),this.emit("error",s);let r=this.getUserFriendlyMessage(t);this.showToast(r,"error")}getUserFriendlyMessage(t){return{INVALID_DATA:"\uC798\uBABB\uB41C \uB370\uC774\uD130 \uD615\uC2DD\uC785\uB2C8\uB2E4.",INVALID_COLUMN:"\uC798\uBABB\uB41C \uCEEC\uB7FC \uC124\uC815\uC785\uB2C8\uB2E4.",RENDER_FAILED:"\uADF8\uB9AC\uB4DC\uB97C \uB80C\uB354\uB9C1\uD558\uB294 \uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.",VALIDATION_FAILED:"\uB370\uC774\uD130 \uAC80\uC99D\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.",ELEMENT_NOT_FOUND:"\uD544\uC218 HTML \uC694\uC18C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.",INITIALIZATION_FAILED:"\uADF8\uB9AC\uB4DC \uCD08\uAE30\uD654\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."}[t.code]||"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."}warn(t,i,s={}){let r={code:t,message:i,details:s,instanceId:this.instanceId,tableId:this.tableId,timestamp:new Date().toISOString()};this.warnings.push(r),console.warn(`\u26A0\uFE0F SmartGrid Warning [${this.tableId}]`,`
${i}`,s),this.emit("warning",r),this.debugMode&&this.showToast(`[\uACBD\uACE0] ${i}`,"warning")}info(t,i={}){this.debugMode&&console.info(`\u2139\uFE0F SmartGrid Info [${this.tableId}]`,`
${t}`,i)}destroy(){this.emit("beforeDestroy"),this.pluginManager?.unregisterAll(),m.instances.delete(this),this.removeAllListeners(),this.uiComponents.destroyAll(),this.wrapper?.remove(),this.renderer.clearTable(),this.table=this.columns=this.originalData=this.currentPageData=this.inputFactory=this.pluginManager=null,console.log(`\u2705 SmartGrid \uC778\uC2A4\uD134\uC2A4 "${this.tableId}" \uC81C\uAC70 \uC644\uB8CC`),m.instances.size===0&&(m.globalEventsInitialized=!1,console.log("\u2705 \uBAA8\uB4E0 SmartGrid \uC778\uC2A4\uD134\uC2A4 \uC815\uB9AC \uC644\uB8CC"))}};u(m,"BUTTON_CONFIG",{Add:{text:"\uCD94\uAC00",action:"addRow",icon:"bi bi-plus-lg"},Edit:{text:"\uC218\uC815",action:"setEditMode",params:[!0],icon:"bi bi-pencil-square"},Save:{text:"\uC800\uC7A5",action:"saveRow",icon:"bi bi-save"},Cancel:{text:"\uCDE8\uC18C",action:"rejectRow",icon:"bi bi-x-circle"},Delete:{text:"\uC0AD\uC81C",action:"deleteRow",icon:"bi bi-trash"},Print:{text:"\uC778\uC1C4",action:"printCurrentPage",icon:"bi bi-printer"}}),u(m,"PAGE_SIZE_OPTIONS",[{value:10,text:"10\uAC1C\uC529"},{value:20,text:"20\uAC1C\uC529"},{value:50,text:"50\uAC1C\uC529"},{value:100,text:"100\uAC1C\uC529"},{value:"all",text:"\uC804\uCCB4 \uBCF4\uAE30"}]),u(m,"instances",new Set),u(m,"globalEventsInitialized",!1);M=m});var x,_=w(()=>{x=class h{constructor(e,t={}){if(this.constructor===h)throw new Error("PluginBase\uB294 \uC9C1\uC811 \uC778\uC2A4\uD134\uC2A4\uD654\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4");this.grid=e,this.options=t,this.initialized=!1}get name(){throw new Error("name getter\uB294 \uBC18\uB4DC\uC2DC \uAD6C\uD604\uD574\uC57C \uD569\uB2C8\uB2E4")}get version(){return"1.0.0"}install(){this.initialized=!0,this.grid.info(`Plugin "${this.name}" v${this.version} installed`)}uninstall(){this.initialized=!1,this.grid.info(`Plugin "${this.name}" uninstalled`)}isInstalled(){return this.initialized}handleError(e,t=""){this.grid.handleError(e,`${this.name}:${t}`)}log(e,t="info"){let i=`[Plugin:${this.name}]`;switch(t){case"error":console.error(i,e);break;case"warn":console.warn(i,e);break;default:console.log(i,e)}}mergeOptions(e,t){return{...e,...t}}}});var rt={};O(rt,{GridExcelPlugin:()=>P});var X,W,P,K=w(()=>{_();X=class{async handle(e,t,i){let{validData:s,errors:r}=e.validate(t,i);if(r.length>0){e.grid.showToast(r[0],"error");return}let n=i.dataProcessor?i.dataProcessor(s):s;e.bind(n,i),e.grid.showToast("\uC5D1\uC140 \uB370\uC774\uD130\uAC00 \uADF8\uB9AC\uB4DC\uC5D0 \uC131\uACF5\uC801\uC73C\uB85C \uBC14\uC778\uB529\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","success")}},W=class{async handle(e,t,i){let{validData:s,errors:r}=e.validate(t,i);if(r.length>0){e.grid.showToast(r[0],"error");return}let n=i.dataProcessor?i.dataProcessor(s):s,a=e.mapData(n,i);e.grid.showConfirmModal(`\uCD1D ${a.length}\uAC74\uC758 \uB370\uC774\uD130\uB97C \uC11C\uBC84\uB85C \uC804\uC1A1\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`,async d=>{d&&await e.sendToServer(a,i)})}},P=class extends x{constructor(e,t={}){super(e,t);let i={columnMap:this.generateColumnMap(),validationRules:this.generateValidationRules(),dataProcessor:null};this.options=this.mergeOptions(i,t)}get name(){return"excel"}get version(){return"1.0.0"}install(){super.install(),this.grid.on("beforeDestroy",()=>this.uninstall())}async upload(e,t={}){try{this.log(`Uploading file: ${e.name}`);let i=this.mergeOptions(this.options,t),s=await this.parse(e);await(i.mode==="direct"?new W:new X).handle(this,s,i),this.log("Upload completed successfully")}catch(i){throw this.handleError(i,"upload"),i}}async download(e="grid_data.xlsx"){try{this.log(`Downloading file: ${e}`);let t=this.grid.getData();if(t.length===0){this.grid.showToast("\uB2E4\uC6B4\uB85C\uB4DC\uD560 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.","info");return}let i=this.prepareExportData(t);if(typeof XLSX>"u")throw new Error("XLSX \uB77C\uC774\uBE0C\uB7EC\uB9AC\uAC00 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");let s=XLSX.utils.json_to_sheet(i),r=XLSX.utils.book_new();XLSX.utils.book_append_sheet(r,s,"Sheet1"),XLSX.writeFile(r,e),this.grid.showToast("\uC5D1\uC140 \uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","success"),this.log("Download completed successfully")}catch(t){throw this.handleError(t,"download"),t}}async send(e={}){try{let t=this.grid.getData();if(!t||t.length===0){this.grid.showToast("\uC804\uC1A1\uD560 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.","warning");return}e.skipConfirm===!0?await this.sendToServer(t,e):this.grid.showConfirmModal(`\uCD1D ${t.length}\uAC74\uC758 \uB370\uC774\uD130\uB97C \uC11C\uBC84\uB85C \uC804\uC1A1\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`,async i=>{i&&await this.sendToServer(t,e)})}catch(t){throw this.handleError(t,"send"),t}}async parse(e){return new Promise((t,i)=>{let s=new FileReader;s.onload=()=>{try{if(typeof XLSX>"u")throw new Error("XLSX \uB77C\uC774\uBE0C\uB7EC\uB9AC\uAC00 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");let r=XLSX.read(s.result,{type:"array",cellDates:!0,raw:!1,dateNF:"yyyy-mm-dd"}),n=r.SheetNames[0],a=r.Sheets[n],d=XLSX.utils.sheet_to_json(a,{header:1,range:0,raw:!1})[0];if(!d||d.length===0)throw new Error("\uC5D1\uC140 \uD30C\uC77C\uC774 \uBE44\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.");let o=XLSX.utils.sheet_to_json(a,{header:d,defval:"",raw:!1,range:1});this.log(`Parsed ${o.length} rows from Excel file`),t(o)}catch(r){i(r)}},s.onerror=r=>i(r),s.readAsArrayBuffer(e)})}validate(e,t){let i=[],s=[],{validationRules:r}=t;for(let[n,a]of e.entries()){let d=[];for(let o in r)if(r[o].required){let l=a[o];(l==null||String(l).trim()==="")&&d.push(`'${o}'`)}if(d.length>0){s.push(`${n+2}\uD589\uC5D0\uC11C ${d.join(", ")} \uD544\uB4DC\uC758 \uAC12\uC774 \uB204\uB77D\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`);break}else i.push(a)}return{validData:i,errors:s}}mapData(e,t){let{columnMap:i}=t;return e.map(s=>{let r={};for(let n in i)s[n]!==void 0&&(r[i[n]]=s[n]);return r})}bind(e,t){let i=this.mapData(e,t);typeof this.grid.applyFormula=="function"&&i.forEach(s=>this.grid.applyFormula(s)),this.grid.invalidateSortCache(),this.grid.pagingMode==="server"?(this.grid.currentPageData=i,this.grid.totalRows=i.length,this.grid.currentPage=1,this.grid.renderGrid(),this.grid.renderPagination(),this.grid.updateTotalRowsInfo()):(this.grid.originalData=i,this.grid.totalRows=i.length,this.grid.currentPage=1,this.grid.currentPageData=i.slice(0,this.grid.pageSize),this.grid.renderGrid(),this.grid.renderPagination(),this.grid.updateTotalRowsInfo()),this.log(`Bound ${i.length} rows to grid`)}async sendToServer(e,t){if(!e||e.length===0){this.grid.showToast("\uC804\uC1A1\uD560 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.","info");return}let i=t.url||"/";this.log(`Sending ${e.length} rows to ${i}`),this.grid.showLoading();try{let s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw new Error(`Server response error: ${s.status}`);let r=await s.json();return this.grid.showToast("\uB370\uC774\uD130\uAC00 \uC131\uACF5\uC801\uC73C\uB85C \uC804\uC1A1\uB418\uC5C8\uC2B5\uB2C8\uB2E4.","success"),this.log("Data sent successfully"),t.clearAfterSend===!0&&(this.grid.loadData([]),this.log("Grid cleared after send")),r}catch(s){throw this.log(`Send failed: ${s.message}`,"error"),this.grid.showToast("\uC11C\uBC84 \uC804\uC1A1 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","error"),s}finally{this.grid.hideLoading()}}generateColumnMap(){return this.grid.columns.reduce((e,t)=>(t.title&&t.field&&(e[t.title]=t.field),e),{})}generateValidationRules(){return this.grid.columns.reduce((e,t)=>(t.title&&t.editor?.required&&(e[t.title]={required:!0}),e),{})}prepareExportData(e){return e.map(t=>{let i={};return this.grid.columns.forEach(s=>{!s.hideColumn&&s.exportExcel!==!1&&(i[s.title]=t[s.field])}),i})}}});var nt={};O(nt,{GridChartPlugin:()=>A});var A,J=w(()=>{_();A=class extends x{constructor(e,t={}){super(e,t);let i={defaultChartType:"bar",modalTitle:"\uB370\uC774\uD130 \uCC28\uD2B8",chartLibrary:window.Chart};this.options=this.mergeOptions(i,t),this.chartModalElement=null,this.chartInstance=null,this.boundHideModal=this._hideModal.bind(this)}get name(){return"chart"}get version(){return"1.2.1"}install(){super.install(),this.createChartModal(),this.grid.on("beforeDestroy",()=>this.uninstall())}uninstall(){this.chartModalElement?.remove(),this.chartModalElement=null,this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null),super.uninstall()}showChart(e={}){if(!this.options.chartLibrary){let t="Chart.js \uB77C\uC774\uBE0C\uB7EC\uB9AC\uAC00 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4. (window.Chart\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4)";this.handleError(new Error(t),"showChart"),this.grid.showToast(t,"error");return}if(!this.chartModalElement){this.handleError(new Error("\uCC28\uD2B8 \uBAA8\uB2EC\uC774 \uCD08\uAE30\uD654\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."),"showChart");return}try{let t=e.type||this.options.defaultChartType,i=e.title||this.options.modalTitle,s=this.generateChartData(e);if(!s)return;let r=this.chartModalElement.querySelector(".smartgrid-modal-title");r&&(r.textContent=i);let n=this.chartModalElement.querySelector("canvas");if(!n){this.handleError(new Error("\uBAA8\uB2EC\uC5D0\uC11C Canvas \uC694\uC18C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),"showChart");return}this.renderChart(n,t,s,e.chartOptions||{}),this.chartModalElement.classList.add("show")}catch(t){this.handleError(t,"showChart"),this.grid.showToast("\uCC28\uD2B8 \uC0DD\uC131 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.","error")}}hideChart(){this._hideModal()}createChartModal(){if(this.chartModalElement)return;let e=document.createElement("div");e.id=`${this.grid.instanceId}_chartModal`,e.className="smartgrid-modal smartgrid-chart-modal",e.setAttribute("data-instance",this.grid.instanceId),e.innerHTML=`
      <div class="smartgrid-modal-backdrop" data-instance="${this.grid.instanceId}"></div>
      <div class="smartgrid-modal-content" data-instance="${this.grid.instanceId}" style="max-width: 800px; width: 90%;">
        <div class="smartgrid-modal-header">
          <h5 class="smartgrid-modal-title">${this.options.modalTitle}</h5>
          <button class="smartgrid-modal-close" data-instance="${this.grid.instanceId}">&times;</button>
        </div>
        <div class="smartgrid-modal-body" style="padding: 1rem; max-height: 70vh; overflow-y: auto;">
          <canvas id="${this.grid.instanceId}_chartCanvas"></canvas>
        </div>
        <div class="smartgrid-modal-footer">
          <button class="smartgrid-btn smartgrid-btn-secondary" data-dismiss="modal" data-instance="${this.grid.instanceId}">\uB2EB\uAE30</button>
        </div>
      </div>
    `,document.body.appendChild(e),this.chartModalElement=e,e.querySelectorAll(`
      [data-dismiss="modal"],
      .smartgrid-modal-close,
      .smartgrid-modal-backdrop
    `).forEach(i=>{i.addEventListener("click",this.boundHideModal)})}_hideModal(){this.chartModalElement&&this.chartModalElement.classList.remove("show"),this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null)}generateChartData(e){let{labelField:t,dataFields:i,groupBy:s}=e;if(!i||Array.isArray(i)&&i.length===0||typeof i!="string"&&!Array.isArray(i))return this.grid.showToast("\uCC28\uD2B8 \uB370\uC774\uD130 \uD544\uB4DC(dataFields)\uAC00 \uC9C0\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.","warning"),null;let r=this.grid.getRows();if(r.length===0)return this.grid.showToast("\uCC28\uD2B8\uB97C \uC0DD\uC131\uD560 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.","info"),null;let n=Array.isArray(i)?i:[i],a=[],d=[];if(s){let o=new Map;r.forEach(l=>{let c=l[s]||"\uBBF8\uBD84\uB958";if(!o.has(c)){let f={};n.forEach(p=>{f[p]=0}),o.set(c,f)}let g=o.get(c);n.forEach(f=>{g[f]+=parseFloat(l[f])||0})}),a=Array.from(o.keys()),d=n.map(l=>{let c=this.grid.columns.find(g=>g.field===l);return{label:c?c.title:l,data:a.map(g=>o.get(g)[l])}})}else a=r.map(o=>t?o[t]:""),d=n.map(o=>{let l=this.grid.columns.find(c=>c.field===o);return{label:l?l.title:o,data:r.map(c=>parseFloat(c[o])||0)}});return{labels:a,datasets:d}}renderChart(e,t,i,s={}){this.chartInstance&&this.chartInstance.destroy();let r=this.options.chartLibrary;try{this.chartInstance=new r(e,{type:t,data:i,options:this.mergeOptions({responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"top"},title:{display:!1}}},s)})}catch(n){this.handleError(n,"renderChart"),this.grid.showToast(`\uCC28\uD2B8 \uB80C\uB354\uB9C1 \uC2E4\uD328: ${n.message}`,"error")}}}});var gt={};O(gt,{ClientSideHandler:()=>C,DataHandler:()=>R,EventEmitter:()=>v,GridChartPlugin:()=>A,GridEvents:()=>L,GridExcelPlugin:()=>P,GridRenderer:()=>$,InputFactory:()=>T,PluginBase:()=>x,ServerSideHandler:()=>S,SmartGrid:()=>M,SmartGridError:()=>y,UIComponents:()=>D,createSvgUse:()=>Q,deepClone:()=>b,default:()=>M,formatNumber:()=>E,getCurrentDateTime:()=>F,isEmpty:()=>et,sleep:()=>tt,stripHtml:()=>Y});B();z();H();V();G();q();j();U();I();_();K();J();H();typeof window<"u"&&(Promise.resolve().then(()=>(H(),st)).then(h=>{window.SmartGrid=h.SmartGrid}),Promise.resolve().then(()=>(K(),rt)).then(h=>{window.GridExcelPlugin=h.GridExcelPlugin}),Promise.resolve().then(()=>(J(),nt)).then(h=>{window.GridChartPlugin=h.GridChartPlugin}));return ut(gt);})();
//# sourceMappingURL=smartgrid.min.js.map
